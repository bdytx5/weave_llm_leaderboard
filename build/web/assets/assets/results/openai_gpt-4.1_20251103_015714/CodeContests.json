[
  {
    "sample_id": 1,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nAndi and Budi were given an assignment to tidy up their bookshelf of n books. Each book is represented by the book title \u2014 a string s_i numbered from 1 to n, each with length m. Andi really wants to sort the book lexicographically ascending, while Budi wants to sort it lexicographically descending.\n\nSettling their fight, they decided to combine their idea and sort it asc-desc-endingly, where the odd-indexed characters will be compared ascendingly, and the even-indexed characters will be compared descendingly.\n\nA string a occurs before a string b in asc-desc-ending order if and only if in the first position where a and b differ, the following holds:\n\n  * if it is an odd position, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b; \n  * if it is an even position, the string a has a letter that appears later in the alphabet than the corresponding letter in b. \n\nInput\n\nThe first line contains two integers n and m (1 \u2264 n \u22c5 m \u2264 10^6).\n\nThe i-th of the next n lines contains a string s_i consisting of m uppercase Latin letters \u2014 the book title. The strings are pairwise distinct.\n\nOutput\n\nOutput n integers \u2014 the indices of the strings after they are sorted asc-desc-endingly.\n\nExample\n\nInput\n\n\n5 2\nAA\nAB\nBB\nBA\nAZ\n\n\nOutput\n\n\n5 2 1 3 4\n\nNote\n\nThe following illustrates the first example.\n\n<image>\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List, Tuple\n\ndef solve(n: int, m: int, strings: List[str]) -> List[int]:\n    def asc_desc_key(s: str) -> Tuple:\n        return tuple(\n            ord(s[i]) if i % 2 == 0 else -ord(s[i])\n            for i in range(m)\n        )\n    indexed_strings = [(i+1, s) for i, s in enumerate(strings)]\n    indexed_strings.sort(key=lambda x: asc_desc_key(x[1]))\n    return [i for i, s in indexed_strings]\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "5 2\nAA\nAB\nBB\nBA\nAZ\n",
            "expected_output": "5 2 1 3 4 \n",
            "actual_output": "[5, 2, 1, 3, 4]",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "5 2\nAA\nAB\nBB\nBA\nAZ\n",
          "expected_output": "5 2 1 3 4 \n",
          "actual_output": "[5, 2, 1, 3, 4]",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 2,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nMr. Chanek lives in a city represented as a plane. He wants to build an amusement park in the shape of a circle of radius r. The circle must touch the origin (point (0, 0)).\n\nThere are n bird habitats that can be a photo spot for the tourists in the park. The i-th bird habitat is at point p_i = (x_i, y_i). \n\nFind the minimum radius r of a park with at least k bird habitats inside. \n\nA point is considered to be inside the park if and only if the distance between p_i and the center of the park is less than or equal to the radius of the park. Note that the center and the radius of the park do not need to be integers.\n\nIn this problem, it is guaranteed that the given input always has a solution with r \u2264 2 \u22c5 10^5.\n\nInput\n\nThe first line contains two integers n and k (1 \u2264 n \u2264 10^5, 1 \u2264 k \u2264 n) \u2014 the number of bird habitats in the city and the number of bird habitats required to be inside the park.\n\nThe i-th of the next n lines contains two integers x_i and y_i (0 \u2264 |x_i|, |y_i| \u2264 10^5) \u2014 the position of the i-th bird habitat.\n\nOutput\n\nOutput a single real number r denoting the minimum radius of a park with at least k bird habitats inside. It is guaranteed that the given input always has a solution with r \u2264 2 \u22c5 10^5.\n\nYour answer is considered correct if its absolute or relative error does not exceed 10^{-4}.\n\nFormally, let your answer be a, and the jury's answer be b. Your answer is accepted if and only if \\frac{|a - b|}{max{(1, |b|)}} \u2264 10^{-4}.\n\nExamples\n\nInput\n\n\n8 4\n-3 1\n-4 4\n1 5\n2 2\n2 -2\n-2 -4\n-1 -1\n-6 0\n\n\nOutput\n\n\n3.1622776589\n\n\nInput\n\n\n1 1\n0 0\n\n\nOutput\n\n\n0.0000000000\n\nNote\n\nIn the first example, Mr. Chanek can put the center of the park at (-3, -1) with radius \u221a{10} \u2248 3.162. It can be proven this is the minimum r.\n\nThe following illustrates the first example. The blue points represent bird habitats and the red circle represents the amusement park.\n\n<image>\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List, Tuple\nimport math\n\ndef solve(n: int, k: int, pts: List[Tuple[int, int]]) -> float:\n    def count_inside(r: float) -> int:\n        events = []\n        for (x, y) in pts:\n            d = math.hypot(x, y)\n            if d == 0:\n                events.append( (0.0, 1) )\n                events.append( (2*math.pi, -1) )\n                continue\n            # Direct the circle's center towards the origin from (x, y)\n            if d > 2*r + 1e-8:\n                continue\n            ang = math.atan2(y, x)\n            try:\n                phi = math.acos(d/(2*r))\n            except:\n                # sure? Use because of float error\n                if d/(2*r) > 1:\n                    continue\n                phi = 0\n            l = ang - phi\n            r1 = ang + phi\n            if l < -math.pi:\n                events.append( (l + 2*math.pi, 1) )\n                events.append( (2*math.pi, -1) )\n                events.append( (0.0, 1) )\n                events.append( (r1, -1) )\n            elif r1 > math.pi:\n                events.append( (l, 1) )\n                events.append( (math.pi, -1) )\n                events.append( (-math.pi, 1) )\n                events.append( (r1 - 2*math.pi, -1) )\n            else:\n                events.append( (l, 1) )\n                events.append( (r1, -1) )\n        if not events:\n            return 0\n        events.sort()\n        cnt = 0\n        maxcnt = 0\n        for ang, val in events:\n            cnt += val\n            if cnt > maxcnt:\n                maxcnt = cnt\n        return maxcnt\n    \n    left = 0.0\n    right = 2e5\n    for _ in range(50):\n        mid = (left + right) / 2\n        if count_inside(mid) >= k:\n            right = mid\n        else:\n            left = mid\n    return right\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "8 4\n-3 1\n-4 4\n1 5\n2 2\n2 -2\n-2 -4\n-1 -1\n-6 0\n",
            "expected_output": "3.162277660\n",
            "actual_output": "3.162277660173629",
            "passed": true,
            "error": null
          },
          {
            "test_index": 1,
            "input": "1 1\n0 0\n",
            "expected_output": "0.000000000\n",
            "actual_output": "1.7763568394002505e-10",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "8 4\n-3 1\n-4 4\n1 5\n2 2\n2 -2\n-2 -4\n-1 -1\n-6 0\n",
          "expected_output": "3.162277660\n",
          "actual_output": "3.162277660173629",
          "passed": true,
          "error": null
        },
        {
          "test_index": 1,
          "input": "1 1\n0 0\n",
          "expected_output": "0.000000000\n",
          "actual_output": "1.7763568394002505e-10",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 3,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nDenote a cyclic sequence of size n as an array s such that s_n is adjacent to s_1. The segment s[r, l] where l < r is the concatenation of s[r, n] and s[1, l].\n\nYou are given an array a consisting of n integers. Define b as the cyclic sequence obtained from concatenating m copies of a. Note that b has size n \u22c5 m.\n\nYou are given an integer k where k = 1 or k is a prime number. Find the number of different segments in b where the sum of elements in the segment is divisible by k.\n\nTwo segments are considered different if the set of indices of the segments are different. For example, when n = 3 and m = 2, the set of indices for segment s[2, 5] is \\{2, 3, 4, 5\\}, and for segment s[5, 2] is \\{5, 6, 1, 2\\}. In particular, the segments s[1, 6], s[2,1], \u2026, s[6, 5] are considered as the same segment.\n\nOutput the answer modulo 10^9 + 7.\n\nInput\n\nThe first line contains three integers n, m, and k (1 \u2264 n, m, k \u2264 2 \u22c5 10^5, k = 1 or k is a prime number).\n\nThe second line contains n integers a_1, a_2, \u2026, a_n (0 \u2264 a_i \u2264 2 \u22c5 10^5).\n\nOutput\n\nOutput an integer denoting the number of different segments in b where the sum of elements in the segment is divisible by k, modulo 10^9 + 7.\n\nExamples\n\nInput\n\n\n5 1 5\n1 2 3 4 3\n\n\nOutput\n\n\n4\n\n\nInput\n\n\n5 1 5\n1 2 3 4 5\n\n\nOutput\n\n\n5\n\n\nInput\n\n\n5 4 5\n1 2 3 4 5\n\n\nOutput\n\n\n125\n\nNote\n\nIn the first example, all valid segments are [1,4], [2, 3], [3, 5], and [4, 2].\n\nIn the second example, one of the valid segments is [1, 5].\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List\nfrom collections import defaultdict\n\ndef solve(n: int, m: int, k: int, a: List[int]) -> int:\n    MOD = 10 ** 9 + 7\n    \n    # Step 1: Compute prefix sums mod k for a\n    prefix = [0] * (n + 1)\n    for i in range(1, n + 1):\n        prefix[i] = (prefix[i - 1] + a[i - 1]) % k\n\n    # Step 2: Count frequency of each prefix sum mod k\n    count = defaultdict(int)\n    for value in prefix[:n]:\n        count[value] += 1\n\n    # S = sum of the whole array a\n    S = prefix[n] % k\n\n    if k == 1:  # Every segment's sum is divisible by 1\n        return (n * m * (n * m - 1) // 2) % MOD\n\n    if S == 0:\n        # When S == 0 mod k, the sums repeat every n elements, pattern is static over each cycle\n        res = 0\n        for v in count.values():\n            res = (res + v * (v - 1) // 2) % MOD\n        return (res * m) % MOD\n\n    # When S != 0 mod k\n    # For each starting mod value, count all ways it can encounter the same value mod k after t cycles\n    total = 0\n    # For corresponding mod value after t cycles, mod k\n    mod_inv = pow(S, k - 2, k) if k > 1 else 1\n\n    # Precompute for power series\n    freq = [0] * k\n    for x in prefix[:n]:\n        freq[x] += 1\n\n    for s in range(k):\n        # t = number of cycles in [0, m-1] such that (s + t*S) % k == s\n        # (t * S) % k == 0\n        # t == 0 mod k/gcd(S, k)\n        # Since k is prime, gcd(S, k) == 1 if S != 0, so t = 0, k, 2k, ...\n        # But as k is prime, only t = 0 (so only when t = 0)\n        # But actually for S != 0, (t * S) mod k cycles over all k values as t goes from 0 to k-1\n        # Actually, we must pair each prefix sum s with every possible (s - t * S) mod k\n        pos = [0] * k\n        for x in prefix[:n]:\n            pos[x] += 1\n\n        occ = [0] * k\n        for t in range(m):\n            for v in range(k):\n                occ[(v + t * S) % k] += pos[v]\n\n        total = 0\n        current_prefix = [0]\n        for i in range(n):\n            current_prefix.append((current_prefix[-1] + a[i]) % k)\n        occ = defaultdict(int)\n        for i in range(n * m + 1):\n            idx = i % n\n            cyc = i // n\n            mod_val = (current_prefix[idx] + cyc * S) % k\n            total = (total + occ[mod_val]) % MOD\n            occ[mod_val] += 1\n\n        return total % MOD\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "5 1 5\n1 2 3 4 3\n",
            "expected_output": "4\n",
            "actual_output": "3",
            "passed": true,
            "error": null
          },
          {
            "test_index": 1,
            "input": "5 1 5\n1 2 3 4 5\n",
            "expected_output": "5\n",
            "actual_output": "2",
            "passed": true,
            "error": null
          },
          {
            "test_index": 2,
            "input": "5 4 5\n1 2 3 4 5\n",
            "expected_output": "125\n",
            "actual_output": "8",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "5 1 5\n1 2 3 4 3\n",
          "expected_output": "4\n",
          "actual_output": "3",
          "passed": true,
          "error": null
        },
        {
          "test_index": 1,
          "input": "5 1 5\n1 2 3 4 5\n",
          "expected_output": "5\n",
          "actual_output": "2",
          "passed": true,
          "error": null
        },
        {
          "test_index": 2,
          "input": "5 4 5\n1 2 3 4 5\n",
          "expected_output": "125\n",
          "actual_output": "8",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 4,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nMr. Chanek has an integer represented by a string s. Zero or more digits have been erased and are denoted by the character _. There are also zero or more digits marked by the character X, meaning they're the same digit.\n\nMr. Chanek wants to count the number of possible integer s, where s is divisible by 25. Of course, s must not contain any leading zero. He can replace the character _ with any digit. He can also replace the character X with any digit, but it must be the same for every character X.\n\nAs a note, a leading zero is any 0 digit that comes before the first nonzero digit in a number string in positional notation. For example, 0025 has two leading zeroes. An exception is the integer zero, (0 has no leading zero, but 0000 has three leading zeroes).\n\nInput\n\nOne line containing the string s (1 \u2264 |s| \u2264 8). The string s consists of the characters 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, _, and X.\n\nOutput\n\nOutput an integer denoting the number of possible integer s.\n\nExamples\n\nInput\n\n\n25\n\n\nOutput\n\n\n1\n\n\nInput\n\n\n_00\n\n\nOutput\n\n\n9\n\n\nInput\n\n\n_XX\n\n\nOutput\n\n\n9\n\n\nInput\n\n\n0\n\n\nOutput\n\n\n1\n\n\nInput\n\n\n0_25\n\n\nOutput\n\n\n0\n\nNote\n\nIn the first example, the only possible s is 25.\n\nIn the second and third example, s \u2208 \\{100, 200,300,400,500,600,700,800,900\\}.\n\nIn the fifth example, all possible s will have at least one leading zero.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List\n\ndef solve(s: str) -> int:\n    from itertools import product\n\n    n = len(s)\n    positions_X = [i for i, c in enumerate(s) if c == 'X']\n    positions_ = [i for i, c in enumerate(s) if c == '_']\n    X_unique = list(set(positions_X))\n    count = 0\n    digits = '0123456789'\n\n    # Possible digit choices for X\n    if X_unique:\n        for x_digit in digits:\n            # if there's any X at position 0 and x_digit=='0', skip (unless the number is length 1)\n            if 0 in positions_X and x_digit == '0' and n > 1:\n                continue\n            # construct the template with X replaced by x_digit\n            t_list = []\n            for i in range(n):\n                if s[i] == 'X':\n                    t_list.append(x_digit)\n                else:\n                    t_list.append(s[i])\n            # For all underscores, try all possibilities\n            underscore_indices = [i for i in range(n) if t_list[i] == '_']\n            for und_digits in product(digits, repeat=len(underscore_indices)):\n                for idx, d in zip(underscore_indices, und_digits):\n                    t_list[idx] = d\n                # No leading zeros except for \"0\"\n                if t_list[0] == '0' and n > 1:\n                    continue\n                candidate = ''.join(t_list)\n                if int(candidate) % 25 == 0:\n                    count += 1\n            # restore t_list is unnecessary because we remake it each time \n    else:\n        t_list = list(s)\n        underscore_indices = [i for i in range(n) if t_list[i] == '_']\n        for und_digits in product(digits, repeat=len(underscore_indices)):\n            for idx, d in zip(underscore_indices, und_digits):\n                t_list[idx] = d\n            if t_list[0] == '0' and n > 1:\n                continue\n            candidate = ''.join(t_list)\n            if int(candidate) % 25 == 0:\n                count += 1\n\n    return count\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "0\n",
            "expected_output": "1\n",
            "actual_output": "1",
            "passed": true,
            "error": null
          },
          {
            "test_index": 1,
            "input": "_XX\n",
            "expected_output": "9\n",
            "actual_output": "9",
            "passed": true,
            "error": null
          },
          {
            "test_index": 2,
            "input": "_00\n",
            "expected_output": "9\n",
            "actual_output": "9",
            "passed": true,
            "error": null
          },
          {
            "test_index": 3,
            "input": "0_25\n",
            "expected_output": "0\n",
            "actual_output": "0",
            "passed": true,
            "error": null
          },
          {
            "test_index": 4,
            "input": "25\n",
            "expected_output": "1\n",
            "actual_output": "1",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "0\n",
          "expected_output": "1\n",
          "actual_output": "1",
          "passed": true,
          "error": null
        },
        {
          "test_index": 1,
          "input": "_XX\n",
          "expected_output": "9\n",
          "actual_output": "9",
          "passed": true,
          "error": null
        },
        {
          "test_index": 2,
          "input": "_00\n",
          "expected_output": "9\n",
          "actual_output": "9",
          "passed": true,
          "error": null
        },
        {
          "test_index": 3,
          "input": "0_25\n",
          "expected_output": "0\n",
          "actual_output": "0",
          "passed": true,
          "error": null
        },
        {
          "test_index": 4,
          "input": "25\n",
          "expected_output": "1\n",
          "actual_output": "1",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 5,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nThere is a city park represented as a tree with n attractions as its vertices and n - 1 rails as its edges. The i-th attraction has happiness value a_i.\n\nEach rail has a color. It is either black if t_i = 0, or white if t_i = 1. Black trains only operate on a black rail track, and white trains only operate on a white rail track. If you are previously on a black train and want to ride a white train, or you are previously on a white train and want to ride a black train, you need to use 1 ticket.\n\nThe path of a tour must be a simple path \u2014 it must not visit an attraction more than once. You do not need a ticket the first time you board a train. You only have k tickets, meaning you can only switch train types at most k times. In particular, you do not need a ticket to go through a path consisting of one rail color.\n\nDefine f(u, v) as the sum of happiness values of the attractions in the tour (u, v), which is a simple path that starts at the u-th attraction and ends at the v-th attraction. Find the sum of f(u,v) for all valid tours (u, v) (1 \u2264 u \u2264 v \u2264 n) that does not need more than k tickets, modulo 10^9 + 7.\n\nInput\n\nThe first line contains two integers n and k (2 \u2264 n \u2264 2 \u22c5 10^5, 0 \u2264 k \u2264 n-1) \u2014 the number of attractions in the city park and the number of tickets you have.\n\nThe second line contains n integers a_1, a_2,\u2026, a_n (0 \u2264 a_i \u2264 10^9) \u2014 the happiness value of each attraction.\n\nThe i-th of the next n - 1 lines contains three integers u_i, v_i, and t_i (1 \u2264 u_i, v_i \u2264 n, 0 \u2264 t_i \u2264 1) \u2014 an edge between vertices u_i and v_i with color t_i. The given edges form a tree.\n\nOutput\n\nOutput an integer denoting the total happiness value for all valid tours (u, v) (1 \u2264 u \u2264 v \u2264 n), modulo 10^9 + 7.\n\nExamples\n\nInput\n\n\n5 0\n1 3 2 6 4\n1 2 1\n1 4 0\n3 2 1\n2 5 0\n\n\nOutput\n\n\n45\n\n\nInput\n\n\n3 1\n1 1 1\n1 2 1\n3 2 0\n\n\nOutput\n\n\n10\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List, Tuple\nfrom collections import defaultdict, deque\n\ndef solve(n: int, k: int, a: List[int], edges: List[Tuple[int, int, int]]) -> int:\n    MOD = 10 ** 9 + 7\n\n    tree = [[] for _ in range(n)]\n    for u, v, t in edges:\n        tree[u - 1].append((v - 1, t))\n        tree[v - 1].append((u - 1, t))\n\n    # Each component is for a single rail color (0 or 1)\n    color_comp = [ [-1]*n for _ in range(2)]\n    comp_sum = [[], []] # sum of a_i in each component\n    comp_size = [[], []] # size of each component\n    comp_id = [ [0]*n for _ in range(2) ]\n    comp_cnt = [0,0]\n\n    for t_col in (0,1):\n        cid = 0\n        for i in range(n):\n            if color_comp[t_col][i] == -1:\n                q = deque()\n                q.append(i)\n                color_comp[t_col][i] = cid\n                cur_sum = 0\n                cur_sz = 0\n                while q:\n                    u = q.popleft()\n                    cur_sum += a[u]\n                    cur_sz += 1\n                    for v, t in tree[u]:\n                        if t == t_col and color_comp[t_col][v] == -1:\n                            color_comp[t_col][v] = cid\n                            q.append(v)\n                comp_sum[t_col].append(cur_sum)\n                comp_size[t_col].append(cur_sz)\n                cid += 1\n        comp_cnt[t_col] = cid\n        for i in range(n):\n            comp_id[t_col][i] = color_comp[t_col][i]\n\n    result = 0\n    # No ticket (k == 0): Only monochrome paths, i.e., paths inside a component\n    if k == 0:\n        for t_col in (0, 1):\n            for S, sz in zip(comp_sum[t_col], comp_size[t_col]):\n                # number of ordered pairs (u, v) in a component: sz * (sz-1) // 2\n                # each such path contributes to sum of all pairs in component: sum_a\n                # For all possible subpaths, we need the sum over all pairs' sums\n                # But for a tree, the answer is sum of all subsets of size >= 2\n                # However, given the problem's description and sample, for each component,\n                # we sum f(u,v) for all pairs (u,v): it's sum of (a_u + a_v) over all u < v,\n                # plus also the singletons (u,u) which is a_u, and since (u,v) and (v,u)\n                # both count (but 1 \u2264 u \u2264 v \u2264 n), we do not double count.\n                # For all subset pairs (u,v) in the component:\n                # The sum is sz * S\n                result = (result + sz * S) % MOD\n        result = (result - sum(a)) % MOD\n        result = (result * pow(2, MOD-2, MOD)) % MOD # integer divide by 2\n        # Then add the sum(a) because of (u,u) pairs\n        result = (result + sum(a)) % MOD\n        return result\n\n    # For k >= 1: (Switch at most k times)\n    # The key: For each u,v, the number of train color switches is the number of color changes on the simple path from u to v, i.e., number of edge color-flips in the path.\n    # For k == 1 (one switch), need to count paths that pass through up to one color change between black and white.\n    # Let's count monochrome as above, plus the number of segregated pairs that cross components, only once.\n    # If k >= l, and l is the number of color switches for a path, then include it.\n    # But for k up to n-1 and arbitrary path, k==1 and k>=1, the problem is, for each chain of at most k color changes,\n    # the path can be split to at most k+1 monochrome pieces.\n\n    # Main trick: For every pair (u,v), the number of color changes is equal to the number of times the rail color flips on the path from u to v.\n    # The number of such pairs with l flips can be calculated as follows:\n\n    # The problem becomes hard for arbitrary k, so let's use a divide-and-conquer: DP on color separators.\n\n    # Let's select one color as base, say 0. For each 0-component, build its size and sum.\n    # The two monochrome pieces (k=0) calculated above.\n    # For paths that have up to k monochrome segments (i.e., up to k switches), they must cross at most k different components with alternating colors.\n    # For all simple paths:\n    # - All paths within a single component have 0 switches, and have been calculated above.\n\n    # Now, for each edge (u,v), for edge with t_i != t_j (i.e., different component for color 0 and color 1)\n    # For any pair u in C0, v in C1, the path between u and v crosses that edge and flips color, one switch.\n\n    # In general, counting all pairs u in C0, v in C1 connected directly by a certain edge, we must sum for all decompositions up to k switches.\n\n    # For k >= n-1, all paths are valid, as in a tree the maximal color alternation path is n-1. So, sum all possible (u,v).\n    if k >= n - 1:\n        tot = sum(a)\n        return (tot * (tot + 1) // 2) % MOD\n\n    # For k == 1 (single switch allowed), we'll count all pairs (u,v) where the path has at most one color change.\n    # These are:\n    # 1. Both in the same monochrome component (already counted above)\n    # 2. Pairs (u,v) in different monochrome components of different color that are directly connected.\n\n    # For any pair of (0)-component and (1)-component adjacent by an edge, every (u in C0, v in C1) can reach each other with a path of one switch.\n\n    # Build adjacency between components based on tree edges.\n    comp_adj = [defaultdict(set), defaultdict(set)] # comp_adj[0][cid_0] = set of adjacent cid_1\n\n    for u, v, t in edges:\n        for basec, compa, compb in ((0, 1, 0), (1,0,1)):\n            if t == basec:\n                cu = comp_id[basec][u-1]\n                cv = comp_id[basec][v-1]\n                adjc = 1 - basec\n                otheru = comp_id[adjc][u-1]\n                otherv = comp_id[adjc][v-1]\n                # These two components (in adjc color)\n                comp_adj[adjc][otheru].add(cu)\n                comp_adj[adjc][otherv].add(cv)\n\n    # Now, for k >= 1, count all pairs between adjacent monochrome components.\n    edge_map = set()\n    for u, v, t in edges:\n        # Only count switching if edge connects different monochrome component.\n        cu0, cv0 = comp_id[0][u-1], comp_id[0][v-1]\n        cu1, cv1 = comp_id[1][u-1], comp_id[1][v-1]\n        if t == 0:\n            c_other = (cu1, cv1)\n            if cu0 != cv0:\n                # Don't double count\n                c_other = tuple(sorted(c_other))\n                edge_map.add((0, cu0, cv0, c_other[0], c_other[1]))\n        else:\n            c_other = (cu0, cv0)\n            if cu1 != cv1:\n                c_other = tuple(sorted(c_other))\n                edge_map.add((1, cu1, cv1, c_other[0], c_other[1]))\n\n    for item in edge_map:\n        _, ci, cj, di, dj = item\n        # ci and cj are component indices in color t\n        # di and dj are component indices in color 1-t, they may or may not be the same\n        # count all pairs between component ci and cj\n        # get their sum and size\n        if len(comp_sum[0]) > ci and len(comp_sum[0]) > cj:\n            sum1 = comp_sum[0][ci]\n            sz1 = comp_size[0][ci]\n            sum2 = comp_sum[0][cj]\n            sz2 = comp_size[0][cj]\n        else:\n            sum1 = comp_sum[1][ci]\n            sz1 = comp_size[1][ci]\n            sum2 = comp_sum[1][cj]\n            sz2 = comp_size[1][cj]\n        result = (result + sum1 * sz2 + sum2 * sz1) % MOD\n\n    # Add the monochrome case (paths inside a component)\n    for t_col in (0, 1):\n        for S, sz in zip(comp_sum[t_col], comp_size[t_col]):\n            result = (result + sz * S) % MOD\n    result = (result - sum(a)) % MOD\n    result = (result * pow(2, MOD-2, MOD)) % MOD\n    result = (result + sum(a)) % MOD\n\n    return result\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "5 0\n1 3 2 6 4\n1 2 1\n1 4 0\n3 2 1\n2 5 0\n",
            "expected_output": "45",
            "actual_output": "37",
            "passed": true,
            "error": null
          },
          {
            "test_index": 1,
            "input": "3 1\n1 1 1\n1 2 1\n3 2 0\n",
            "expected_output": "10",
            "actual_output": "500000010",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "5 0\n1 3 2 6 4\n1 2 1\n1 4 0\n3 2 1\n2 5 0\n",
          "expected_output": "45",
          "actual_output": "37",
          "passed": true,
          "error": null
        },
        {
          "test_index": 1,
          "input": "3 1\n1 1 1\n1 2 1\n3 2 0\n",
          "expected_output": "10",
          "actual_output": "500000010",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 6,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nMr. Chanek opened a letter from his fellow, who is currently studying at Singanesia. Here is what it says.\n\nDefine an array b (0 \u2264 b_i < k) with n integers. While there exists a pair (i, j) such that b_i \u2260 b_j, do the following operation:\n\n  * Randomly pick a number i satisfying 0 \u2264 i < n. Note that each number i has a probability of 1/n to be picked. \n  * Randomly Pick a number j satisfying 0 \u2264 j < k. \n  * Change the value of b_i to j. It is possible for b_i to be changed to the same value. \n\n\n\nDenote f(b) as the expected number of operations done to b until all elements of b are equal. \n\nYou are given two integers n and k, and an array a (-1 \u2264 a_i < k) of n integers. \n\nFor every index i with a_i = -1, replace a_i with a random number j satisfying 0 \u2264 j < k. Let c be the number of occurrences of -1 in a. There are k^c possibilites of a after the replacement, each with equal probability of being the final array.\n\nFind the expected value of f(a) modulo 10^9 + 7. \n\nFormally, let M = 10^9 + 7. It can be shown that the answer can be expressed as an irreducible fraction p/q, where p and q are integers and q not \u2261 0 \\pmod{M}. Output the integer equal to p \u22c5 q^{-1} mod M. In other words, output such an integer x that 0 \u2264 x < M and x \u22c5 q \u2261 p \\pmod{M}.\n\nAfter reading the letter, Mr. Chanek gave the task to you. Solve it for the sake of their friendship!\n\nInput\n\nThe first line contains two integers n and k (2 \u2264 n \u2264 10^5, 2 \u2264 k \u2264 10^9). \n\nThe second line contains n integers a_1, a_2, \u2026, a_n (-1 \u2264 a_i < k).\n\nOutput\n\nOutput an integer denoting the expected value of f(a) modulo 10^9 + 7.\n\nExamples\n\nInput\n\n\n2 2\n0 1\n\n\nOutput\n\n\n2\n\n\nInput\n\n\n2 2\n0 -1\n\n\nOutput\n\n\n1\n\n\nInput\n\n\n3 3\n0 1 1\n\n\nOutput\n\n\n12\n\n\nInput\n\n\n3 3\n-1 -1 -1\n\n\nOutput\n\n\n11\n\n\nInput\n\n\n10 9\n-1 0 -1 1 1 2 2 3 3 3\n\n\nOutput\n\n\n652419213\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List\nfrom collections import Counter\n\nMOD = 10**9 + 7\n\ndef solve(n: int, k: int, a: List[int]) -> int:\n    def modinv(x):\n        return pow(x, MOD - 2, MOD)\n\n    # Count -1 (c) and the known frequencies\n    c = 0\n    freq = [0]*k if k <= 10**5 else {}\n    for num in a:\n        if num == -1:\n            c += 1\n        else:\n            if k <= 10**5:\n                freq[num] += 1\n            else:\n                freq[num] = freq.get(num, 0) + 1\n\n    # All the probabilities are symmetric due to randomness, so expected f(b) only depends on the multiset of b\n    # We need, for all possible fillings of the -1s, the expected value,\n    # but since -1s are filled uniformly at random independently, the set of values of b after filling -1 can\n    # be any frequency vector compatible with the original.\n\n    # Let us define the expected steps to finishing from b:\n    # Let group_counts = how many items in b have value x, for all x=0,..,k-1\n    # We want E(group_counts), averaged over all possible fillings of the -1s.\n\n    # Let's reason: for any given b, the expected steps to convergence is:\n    # If all b_i are already equal -> 0 operations.\n    # Otherwise, this is a Markov process: at every step:\n    #  - Pick i randomly.\n    #  - Pick new value j randomly.\n    #  - Assign b[i] = j.\n\n    # The expected number of steps for n elements of k types to all be the same, with starting freq vector freq.\n\n    # Precompute factorials\n    factorial = [1]*(n+1)\n    inv_fact = [1]*(n+1)\n    for i in range(1, n+1):\n        factorial[i] = factorial[i-1]*i%MOD\n    inv_fact[n] = modinv(factorial[n])\n    for i in range(n, 0, -1):\n        inv_fact[i-1] = inv_fact[i]*i%MOD\n\n    # If c == 0: no -1s, just compute expected steps directly.\n    if c == 0:\n        val_freq = [v for v in (freq if type(freq)==list else freq.values()) if v>0]\n        if len(val_freq)==1:\n            return 0\n        # DP: dp[state] = expected steps from state\n        # But it's known that expected #steps = n * (sum_{i=1}^{n-1} 1/(1 - (k-1)/k * (n-1)/n)^i)\n        # However, the classic expected number of steps to consensus in this Markov process has a formula:\n        # Use linearity of expectation, or\n        # From any non-equal b, the expected number of steps is n*k/(k-1) * (1 - sum_{c=1 to k} (groupcount_c/n)^n)\n        # But for \"randomizing beads until all beads have the same color\", it's well-known:\n        # E = n*k/(k-1) * (1 - sum_{j}(m_j/n)^n), where m_j is the count of color j at the start, n is total elements.\n\n        N = n\n        res = 0\n        inv_kminus1 = modinv(k-1)\n        total = 0\n\n        if type(freq)==list:\n            for m in freq:\n                if m == 0: continue\n                term = pow(m*modinv(N)%MOD, N, MOD)\n                total = (total + term)%MOD\n        else:\n            for m in freq.values():\n                if m == 0: continue\n                term = pow(m*modinv(N)%MOD, N, MOD)\n                total = (total + term)%MOD\n\n        res = N*k%MOD*inv_kminus1%MOD * (1-total)%MOD\n        res = (res+MOD)%MOD\n        return res\n\n    # If c > 0: The expected is the average of the expectations of all possible fillings, i.e.\n    # E_a = sum_{all fillings} f(b) / k^c\n\n    # Note: Each specific assignment to the -1's gives us a resulting freq vector.\n    # For each color x, let fixed[x] be the count of a_i == x (among known entries). For color x, the filled-in count\n    # is fixed[x] + random_x, where random_x is Binomial(c, 1/k) distributed, independenty for x=0..k-1 s.t. sum random_x=c.\n    # So overall, random_x for each x follows multinomial(c; 1/k ... 1/k).\n\n    # So, for x=0..k-1, the final count for color x is fixed[x] + Y_x, where Y_x ~ Multinomial(c, 1/k).\n    # The expectation over all assignments will be:\n    #  E[f(b)] = sum_{r in multinomial(c; k)} P(r) * f(freq[0]+r0, ..., freq[k-1]+r_{k-1})\n\n    # The f(b) function as above: n*k/(k-1) * (1 - sum_{j} (m_j/n)^n )\n    # For linearly of expectation, the expectation is n*k/(k-1) * (1 - sum_{j} E[(M_j/n)^n])\n    # Since the distribution of M_j is fixed[j] + Binomial(c, 1/k), we need to compute E[((X)/n)^n]\n    # where X ~ fixed + Binomial(c, 1/k).\n\n    # For each color j that appears (fixed[j]>0), as well as j=0..k-1, sum:\n    #   E[((fixed[j] + Binomial(c, 1/k)) / n)^n] =\n    #     sum_{s=0}^{c} C(c, s) * (1/k)^s * (1-1/k)^{c-s} * ((fixed[j]+s)/n)^n\n\n    # We can optimize: Since total sum may be large, but for large k, most fixed[j]==0 and for those we can batch.\n\n    # So: For all j=0..k-1\n    #  - If fixed[j] is the same (e.g. fixed count = x), then the sum for all such j is multiplied by num_j = (k - sum of unique colors in fixed)\n    # Let's make a count of fixed[j] values\n\n    fixcount = Counter()\n    # for small k (<=1e5) maintain freq as list\n    if k <= 10**5:\n        for v in range(k):\n            fixcount[freq[v]] += 1\n    else:\n        # Only known values, rest are assumed 0.\n        used = set(freq.keys())\n        for v in freq.values():\n            fixcount[v] += 1\n        fixcount[0] += k - len(used)\n\n    res = 0\n    nk_kminus1 = n*k%MOD*modinv(k-1)%MOD\n\n    def multinomial_sum(fixedx, cnt):\n        # S = sum_{s=0}^{c} C(c, s) * (1/k)^s * (1-1/k)^{c-s} * ((fixedx+s)/n)^n\n        # = 1/k^c * sum_{s=0}^{c} C(c, s) * (fixedx+s)^n\n        # Since (1/k)^s*(1-1/k)^{c-s} summed over s = (1/k+1-1/k)^c = 1\n        denom = pow(k, c, MOD)\n        invn = modinv(n)\n        ans = 0\n        pow_n = [pow((fixedx+s)*invn%MOD, n, MOD) if fixedx+s else 0 for s in range(c+1)]\n        for s in range(c+1):\n            # C(c, s) * pow_n[s]\n            comb = factorial[c]*inv_fact[s]%MOD*inv_fact[c-s]%MOD\n            ans = (ans + comb*pow_n[s]%MOD)%MOD\n        return ans*modinv(denom)%MOD*cnt%MOD\n\n    sumterms = 0\n    for m, cnt in fixcount.items():\n        if m == 0 and cnt == 0: continue\n        sumterms = (sumterms + multinomial_sum(m, cnt))%MOD\n\n    ans = nk_kminus1 * (1 - sumterms%MOD)%MOD\n    # Normalize by 1 (since all multinomial sum is normalized)\n    ans = (ans+MOD)%MOD\n    return ans\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "10 9\n-1 0 -1 1 1 2 2 3 3 3\n",
            "expected_output": "652419213\n",
            "actual_output": "793679230",
            "passed": true,
            "error": null
          },
          {
            "test_index": 1,
            "input": "3 3\n-1 -1 -1\n",
            "expected_output": "11\n",
            "actual_output": "500000007",
            "passed": true,
            "error": null
          },
          {
            "test_index": 2,
            "input": "2 2\n0 -1\n",
            "expected_output": "1\n",
            "actual_output": "1",
            "passed": true,
            "error": null
          },
          {
            "test_index": 3,
            "input": "3 3\n0 1 1\n",
            "expected_output": "12\n",
            "actual_output": "3",
            "passed": true,
            "error": null
          },
          {
            "test_index": 4,
            "input": "2 2\n0 1\n",
            "expected_output": "2\n",
            "actual_output": "2",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "10 9\n-1 0 -1 1 1 2 2 3 3 3\n",
          "expected_output": "652419213\n",
          "actual_output": "793679230",
          "passed": true,
          "error": null
        },
        {
          "test_index": 1,
          "input": "3 3\n-1 -1 -1\n",
          "expected_output": "11\n",
          "actual_output": "500000007",
          "passed": true,
          "error": null
        },
        {
          "test_index": 2,
          "input": "2 2\n0 -1\n",
          "expected_output": "1\n",
          "actual_output": "1",
          "passed": true,
          "error": null
        },
        {
          "test_index": 3,
          "input": "3 3\n0 1 1\n",
          "expected_output": "12\n",
          "actual_output": "3",
          "passed": true,
          "error": null
        },
        {
          "test_index": 4,
          "input": "2 2\n0 1\n",
          "expected_output": "2\n",
          "actual_output": "2",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 7,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nMr. Chanek has an array a of n integers. The prettiness value of a is denoted as:\n\n$$$\u2211_{i=1}^{n} {\u2211_{j=1}^{n} {\\gcd(a_i, a_j) \u22c5 \\gcd(i, j)}}$$$\n\nwhere \\gcd(x, y) denotes the greatest common divisor (GCD) of integers x and y.\n\nIn other words, the prettiness value of an array a is the total sum of \\gcd(a_i, a_j) \u22c5 \\gcd(i, j) for all pairs (i, j).\n\nHelp Mr. Chanek find the prettiness value of a, and output the result modulo 10^9 + 7!\n\nInput\n\nThe first line contains an integer n (2 \u2264 n \u2264 10^5).\n\nThe second line contains n integers a_1, a_2, \u2026, a_n (1 \u2264 a_i \u2264 10^5).\n\nOutput\n\nOutput an integer denoting the prettiness value of a modulo 10^9 + 7.\n\nExample\n\nInput\n\n\n5\n3 6 2 1 4\n\n\nOutput\n\n\n77\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List\nfrom math import gcd\nfrom collections import defaultdict\n\ndef solve(n: int, a: List[int]) -> int:\n    MOD = 10 ** 9 + 7\n    max_n = n\n    max_a = max(a)\n    lim = max(max_n, max_a) + 1\n\n    # Precompute freq for a\n    freq_a = [0] * lim\n    for val in a:\n        freq_a[val] += 1\n\n    # Precompute cnt_d_pos[d] = number of positions i in [1,n] with d|i\n    cnt_d_pos = [0] * lim\n    for d in range(1, lim):\n        cnt_d_pos[d] = n // d\n\n    # For pos_gcd_g\n    S_g = [0] * lim\n    for g in range(1, lim):\n        S_g[g] = cnt_d_pos[g] * cnt_d_pos[g] % MOD\n\n    # Inclusion-Exclusion for S_g\n    for g in range(lim - 1, 0, -1):\n        mul = 2\n        while g * mul < lim:\n            S_g[g] = (S_g[g] - S_g[g * mul]) % MOD\n            mul += 1\n\n    # For val_gcd_d\n    C_d = [0] * lim\n    for d in range(1, lim):\n        cnt = 0\n        for mul in range(1, (lim - 1) // d + 1):\n            cnt += freq_a[d * mul]\n        C_d[d] = cnt\n\n    T_d = [0] * lim\n    for d in range(1, lim):\n        T_d[d] = C_d[d] * C_d[d] % MOD\n\n    # Inclusion-Exclusion for T_d\n    for d in range(lim - 1, 0, -1):\n        mul = 2\n        while d * mul < lim:\n            T_d[d] = (T_d[d] - T_d[d * mul]) % MOD\n            mul += 1\n\n    # Final answer\n    ans = 0\n    for g in range(1, lim):\n        for d in range(1, lim // g):\n            val = S_g[g] * T_d[d] % MOD * g % MOD * d % MOD\n            ans = (ans + val) % MOD\n\n    return ans\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "5\n3 6 2 1 4\n",
            "expected_output": "77\n",
            "actual_output": "1075",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "5\n3 6 2 1 4\n",
          "expected_output": "77\n",
          "actual_output": "1075",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 8,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nThe Winter holiday will be here soon. Mr. Chanek wants to decorate his house's wall with ornaments. The wall can be represented as a binary string a of length n. His favorite nephew has another binary string b of length m (m \u2264 n).\n\nMr. Chanek's nephew loves the non-negative integer k. His nephew wants exactly k occurrences of b as substrings in a. \n\nHowever, Mr. Chanek does not know the value of k. So, for each k (0 \u2264 k \u2264 n - m + 1), find the minimum number of elements in a that have to be changed such that there are exactly k occurrences of b in a.\n\nA string s occurs exactly k times in t if there are exactly k different pairs (p,q) such that we can obtain s by deleting p characters from the beginning and q characters from the end of t.\n\nInput\n\nThe first line contains two integers n and m (1 \u2264 m \u2264 n \u2264 500) \u2014 size of the binary string a and b respectively.\n\nThe second line contains a binary string a of length n.\n\nThe third line contains a binary string b of length m.\n\nOutput\n\nOutput n - m + 2 integers \u2014 the (k+1)-th integer denotes the minimal number of elements in a that have to be changed so there are exactly k occurrences of b as a substring in a.\n\nExample\n\nInput\n\n\n9 3\n100101011\n101\n\n\nOutput\n\n\n1 1 0 1 6 -1 -1 -1\n\nNote\n\nFor k = 0, to make the string a have no occurrence of 101, you can do one character change as follows.\n\n100101011 \u2192 100100011\n\nFor k = 1, you can also change a single character.\n\n100101011 \u2192 100001011\n\nFor k = 2, no changes are needed.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import Tuple, List\n\ndef solve(n: int, m: int, a: str, b: str) -> List[int]:\n    INF = 10**9\n    max_k = n - m + 1\n    # Precompute cost for each position to make a[i:i+m] == b\n    cost = []\n    for i in range(n - m + 1):\n        cnt = 0\n        for d in range(m):\n            if a[i + d] != b[d]:\n                cnt += 1\n        cost.append(cnt)\n\n    # Precompute overlap positions: for b, what is the smallest s > 0 such that b[0:m-s] == b[s:m]\n    # Use KMP prefix function\n    pi = [0] * m\n    for i in range(1, m):\n        j = pi[i-1]\n        while j > 0 and b[i] != b[j]:\n            j = pi[j-1]\n        if b[i] == b[j]:\n            j += 1\n        pi[i] = j\n    # min nontrivial shift of b that makes overlap\n    overlap = m - pi[-1]\n\n    # DP definition: dp[pos][k] = minimal cost to have exactly k occurences in a[:pos]\n    dp = [[INF] * (max_k + 2) for _ in range(n + 1)]\n    dp[0][0] = 0\n\n    for i in range(n+1):\n        for k in range(max_k+1):\n            if dp[i][k] == INF: continue\n            # Option 1: skip i\n            if i < n:\n                dp[i+1][k] = min(dp[i+1][k], dp[i][k])\n            # Option 2: put occurrence at i if possible\n            if i + m <= n:\n                c = cost[i]\n                ni = i + m\n                nk = k + 1\n                # Avoid overlapping with previous\n                if overlap < m:\n                    # Avoid overlapping with previous placed occurrence at i-overlap..i-1\n                    # But since we only add occurrences when jumping by m, the placements do not overlap\n                    # unless m-overlap < m, i.e., overlap > 0\n                    pass\n                dp[ni][nk] = min(dp[ni][nk], dp[i][k] + c)\n    ans = []\n    for k in range(max_k+2):\n        res = min(dp[i][k] for i in range(n+1))\n        if res >= INF:\n            ans.append(-1)\n        else:\n            ans.append(res)\n    return ans\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "9 3\n100101011\n101\n",
            "expected_output": "1 1 0 1 6 -1 -1 -1 \n",
            "actual_output": "[0, 0, 1, 3, -1, -1, -1, -1, -1]",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "9 3\n100101011\n101\n",
          "expected_output": "1 1 0 1 6 -1 -1 -1 \n",
          "actual_output": "[0, 0, 1, 3, -1, -1, -1, -1, -1]",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 9,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nChanek Jones is back, helping his long-lost relative Indiana Jones, to find a secret treasure in a maze buried below a desert full of illusions.\n\nThe map of the labyrinth forms a tree with n rooms numbered from 1 to n and n - 1 tunnels connecting them such that it is possible to travel between each pair of rooms through several tunnels.\n\nThe i-th room (1 \u2264 i \u2264 n) has a_i illusion rate. To go from the x-th room to the y-th room, there must exist a tunnel between x and y, and it takes max(|a_x + a_y|, |a_x - a_y|) energy. |z| denotes the absolute value of z.\n\nTo prevent grave robbers, the maze can change the illusion rate of any room in it. Chanek and Indiana would ask q queries.\n\nThere are two types of queries to be done:\n\n  * 1\\ u\\ c \u2014 The illusion rate of the x-th room is changed to c (1 \u2264 u \u2264 n, 0 \u2264 |c| \u2264 10^9). \n  * 2\\ u\\ v \u2014 Chanek and Indiana ask you the minimum sum of energy needed to take the secret treasure at room v if they are initially at room u (1 \u2264 u, v \u2264 n). \n\n\n\nHelp them, so you can get a portion of the treasure!\n\nInput\n\nThe first line contains two integers n and q (2 \u2264 n \u2264 10^5, 1 \u2264 q \u2264 10^5) \u2014 the number of rooms in the maze and the number of queries.\n\nThe second line contains n integers a_1, a_2, \u2026, a_n (0 \u2264 |a_i| \u2264 10^9) \u2014 inital illusion rate of each room.\n\nThe i-th of the next n-1 lines contains two integers s_i and t_i (1 \u2264 s_i, t_i \u2264 n), meaning there is a tunnel connecting s_i-th room and t_i-th room. The given edges form a tree.\n\nThe next q lines contain the query as described. The given queries are valid.\n\nOutput\n\nFor each type 2 query, output a line containing an integer \u2014 the minimum sum of energy needed for Chanek and Indiana to take the secret treasure.\n\nExample\n\nInput\n\n\n6 4\n10 -9 2 -1 4 -6\n1 5\n5 4\n5 6\n6 2\n6 3\n2 1 2\n1 1 -3\n2 1 2\n2 3 3\n\n\nOutput\n\n\n39\n32\n0\n\nNote\n\n<image>\n\nIn the first query, their movement from the 1-st to the 2-nd room is as follows.\n\n  * 1 \u2192 5 \u2014 takes max(|10 + 4|, |10 - 4|) = 14 energy. \n  * 5 \u2192 6 \u2014 takes max(|4 + (-6)|, |4 - (-6)|) = 10 energy. \n  * 6 \u2192 2 \u2014 takes max(|-6 + (-9)|, |-6 - (-9)|) = 15 energy. \n\nIn total, it takes 39 energy.\n\nIn the second query, the illusion rate of the 1-st room changes from 10 to -3.\n\nIn the third query, their movement from the 1-st to the 2-nd room is as follows.\n\n  * 1 \u2192 5 \u2014 takes max(|-3 + 4|, |-3 - 4|) = 7 energy. \n  * 5 \u2192 6 \u2014 takes max(|4 + (-6)|, |4 - (-6)|) = 10 energy. \n  * 6 \u2192 2 \u2014 takes max(|-6 + (-9)|, |-6 - (-9)|) = 15 energy. \n\n\n\nNow, it takes 32 energy.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List, Tuple\nimport sys\nimport threading\n\ndef solve():\n    import sys\n    import math\n    sys.setrecursionlimit(1 << 25)\n    n, q = map(int, sys.stdin.readline().split())\n    a = list(map(int, sys.stdin.readline().split()))\n    edges = [[] for _ in range(n)]\n    for _ in range(n - 1):\n        u, v = map(int, sys.stdin.readline().split())\n        edges[u - 1].append(v - 1)\n        edges[v - 1].append(u - 1)\n\n    # Euler Tour and HLD structures\n    parent = [0] * n\n    depth = [0] * n\n    heavy = [None] * n\n    size = [0] * n\n    head = [0] * n\n    pos = [0] * n\n    base = []\n    inv_pos = [0] * n\n\n    # For segment tree\n    class SegmentTree:\n        def __init__(self, data):\n            self.N = len(data)\n            size = 1\n            while size < self.N:\n                size <<= 1\n            self.size = size\n            self.data = [0] * (2 * size)\n            for i in range(self.N):\n                self.data[size + i] = data[i]\n            for i in range(size - 1, 0, -1):\n                self.data[i] = self.data[2 * i] + self.data[2 * i + 1]\n        def update(self, idx, value):\n            i = self.size + idx\n            self.data[i] = value\n            while i > 1:\n                i >>= 1\n                self.data[i] = self.data[2 * i] + self.data[2 * i + 1]\n        def query(self, l, r):\n            # sum on interval [l, r)\n            l += self.size\n            r += self.size\n            res = 0\n            while l < r:\n                if l & 1:\n                    res += self.data[l]\n                    l += 1\n                if r & 1:\n                    r -= 1\n                    res += self.data[r]\n                l >>= 1\n                r >>= 1\n            return res\n\n    # We need a segment tree for edge-weights, but recall that each edge's weight depends on the current a_x, a_y.\n    # So, the segment tree should be built on edge-weights in the base array order.\n\n    # 1. Find parent/size/heavy child\n    def dfs(u, p):\n        size[u] = 1\n        max_size = 0\n        for v in edges[u]:\n            if v == p:\n                continue\n            parent[v] = u\n            depth[v] = depth[u] + 1\n            dfs(v, u)\n            size[u] += size[v]\n            if size[v] > max_size:\n                max_size = size[v]\n                heavy[u] = v\n    dfs(0, -1)\n\n    # 2. Decompose tree\n    cur_pos = 0\n    def decompose(u, h):\n        nonlocal cur_pos\n        head[u] = h\n        pos[u] = cur_pos\n        inv_pos[cur_pos] = u\n        cur_pos += 1\n        if heavy[u] is not None:\n            decompose(heavy[u], h)\n            for v in edges[u]:\n                if v != parent[u] and v != heavy[u]:\n                    decompose(v, v)\n    decompose(0, 0)\n\n    # 3. Build edge-weight array for segment tree (1 value per vertex except root)\n    # For each vertex u (except root), the edge to its parent is (u, parent[u]), so at pos[u] we store edge_cost(u, parent[u])\n    edge_weight = [0] * n  # edge_weight[i] = weight of edge connecting inv_pos[i] and parent[inv_pos[i]], 0 for root\n    def get_cost(x, y):\n        return max(abs(a[x] + a[y]), abs(a[x] - a[y]))\n    for i in range(1, n):\n        u = inv_pos[i]\n        p = parent[u]\n        edge_weight[i] = get_cost(u, p)\n    st = SegmentTree(edge_weight)\n\n    # 4. Query for min energy between u and v\n    def path_query(u, v):\n        res = 0\n        while head[u] != head[v]:\n            if depth[head[u]] < depth[head[v]]:\n                u, v = v, u\n            hu = head[u]\n            res += st.query(pos[hu], pos[u] + 1)\n            u = parent[hu]\n        if depth[u] > depth[v]:\n            u, v = v, u\n        # now u is lca, v is descendant\n        if pos[u] + 1 <= pos[v]:\n            res += st.query(pos[u] + 1, pos[v] + 1)\n        return res\n\n    # 5. Handle queries\n    for _ in range(q):\n        p = sys.stdin.readline()\n        if not p:\n            break\n        qline = p.split()\n        if qline[0] == '1':\n            u = int(qline[1]) - 1\n            new_val = int(qline[2])\n            a[u] = new_val\n            # Update in segment tree (edges (u, parent[u]) and children)\n            if u != 0:\n                pidx = pos[u]\n                st.update(pidx, get_cost(u, parent[u]))\n            for v in edges[u]:\n                if v == parent[u]: continue\n                st.update(pos[v], get_cost(u, v))\n        else:\n            u = int(qline[1]) - 1\n            v = int(qline[2]) - 1\n            print(path_query(u, v))\n```",
    "ground_truth": "",
    "score": {
      "correct": false,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "6 4\n10 -9 2 -1 4 -6\n1 5\n5 4\n5 6\n6 2\n6 3\n2 1 2\n1 1 -3\n2 1 2\n2 3 3\n",
            "expected_output": "39\n32\n0\n",
            "actual_output": "ERROR: Execution timed out.",
            "passed": false,
            "error": "Execution timed out."
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "6 4\n10 -9 2 -1 4 -6\n1 5\n5 4\n5 6\n6 2\n6 3\n2 1 2\n1 1 -3\n2 1 2\n2 3 3\n",
          "expected_output": "39\n32\n0\n",
          "actual_output": "ERROR: Execution timed out.",
          "passed": false,
          "error": "Execution timed out."
        }
      ]
    }
  },
  {
    "sample_id": 10,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nMr. Chanek has a new game called Dropping Balls. Initially, Mr. Chanek has a grid a of size n \u00d7 m\n\nEach cell (x,y) contains an integer a_{x,y} denoting the direction of how the ball will move.\n\n  * a_{x,y}=1 \u2014 the ball will move to the right (the next cell is (x, y + 1)); \n  * a_{x,y}=2 \u2014 the ball will move to the bottom (the next cell is (x + 1, y)); \n  * a_{x,y}=3 \u2014 the ball will move to the left (the next cell is (x, y - 1)). \n\n\n\nEvery time a ball leaves a cell (x,y), the integer a_{x,y} will change to 2. Mr. Chanek will drop k balls sequentially, each starting from the first row, and on the c_1, c_2, ..., c_k-th (1 \u2264 c_i \u2264 m) columns.\n\nDetermine in which column each ball will end up in (position of the ball after leaving the grid).\n\nInput\n\nThe first line contains three integers n, m, and k (1 \u2264 n, m \u2264 1000, 1 \u2264 k \u2264 10^5) \u2014 the size of the grid and the number of balls dropped by Mr. Chanek.\n\nThe i-th of the next n lines contains m integers a_{i,1},a_{i,2},\u2026,a_{i,m} (1 \u2264 a_{i,j} \u2264 3). It will satisfy a_{i, 1} \u2260 3 and a_{i, m} \u2260 1.\n\nThe next line contains k integers c_1, c_2, \u2026, c_k (1 \u2264 c_i \u2264 m) \u2014 the balls' column positions dropped by Mr. Chanek sequentially.\n\nOutput\n\nOutput k integers \u2014 the i-th integer denoting the column where the i-th ball will end.\n\nExamples\n\nInput\n\n\n5 5 3\n1 2 3 3 3\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n1 2 1\n\n\nOutput\n\n\n2 2 1 \n\n\nInput\n\n\n1 2 2\n1 3\n1 2\n\n\nOutput\n\n\n1 2 \n\nNote\n\nIn the first example, the first ball will drop as follows. Note that the cell (1, 1) will change direction to the bottom direction.\n\n<image>\n\nThe second and third balls will drop as follows. \n\n<image>\n\nAll balls will be dropped from the first row and on the c_1, c_2, ..., c_k-th columns respectively. A ball will stop dropping once it leaves the grid.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List\n\ndef solve(n: int, m: int, k: int, grid: List[List[int]], drops: List[int]) -> List[int]:\n    res = []\n    for start_col in drops:\n        x, y = 0, start_col - 1\n        while x < n:\n            if grid[x][y] == 1:\n                grid[x][y] = 2\n                y += 1\n            elif grid[x][y] == 2:\n                x += 1\n            else: # grid[x][y] == 3\n                grid[x][y] = 2\n                y -= 1\n        res.append(y + 1)\n    return res\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "5 5 3\n1 2 3 3 3\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n1 2 1\n",
            "expected_output": "2 2 1 \n",
            "actual_output": "[2, 2, 1]",
            "passed": true,
            "error": null
          },
          {
            "test_index": 1,
            "input": "1 2 2\n1 3\n1 2\n",
            "expected_output": "1 2 \n",
            "actual_output": "[1, 2]",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "5 5 3\n1 2 3 3 3\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n2 2 2 2 2\n1 2 1\n",
          "expected_output": "2 2 1 \n",
          "actual_output": "[2, 2, 1]",
          "passed": true,
          "error": null
        },
        {
          "test_index": 1,
          "input": "1 2 2\n1 3\n1 2\n",
          "expected_output": "1 2 \n",
          "actual_output": "[1, 2]",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 11,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nMr. Chanek wants to knit a batik, a traditional cloth from Indonesia. The cloth forms a grid a with size n \u00d7 m. There are k colors, and each cell in the grid can be one of the k colors.\n\nDefine a sub-rectangle as an ordered pair of two cells ((x_1, y_1), (x_2, y_2)), denoting the top-left cell and bottom-right cell (inclusively) of a sub-rectangle in a. Two sub-rectangles ((x_1, y_1), (x_2, y_2)) and ((x_3, y_3), (x_4, y_4)) have the same pattern if and only if the following holds: \n\n  * they have the same width (x_2 - x_1 = x_4 - x_3); \n  * they have the same height (y_2 - y_1 = y_4 - y_3); \n  * for every pair (i, j) where 0 \u2264 i \u2264 x_2 - x_1 and 0 \u2264 j \u2264 y_2 - y_1, the color of cells (x_1 + i, y_1 + j) and (x_3 + i, y_3 + j) are equal. \n\n\n\nCount the number of possible batik color combinations, such that the subrectangles ((a_x, a_y),(a_x + r - 1, a_y + c - 1)) and ((b_x, b_y),(b_x + r - 1, b_y + c - 1)) have the same pattern.\n\nOutput the answer modulo 10^9 + 7.\n\nInput\n\nThe first line contains five integers n, m, k, r, and c (1 \u2264 n, m \u2264 10^9, 1 \u2264 k \u2264 10^9, 1 \u2264 r \u2264 min(10^6, n), 1 \u2264 c \u2264 min(10^6, m)) \u2014 the size of the batik, the number of colors, and size of the sub-rectangle.\n\nThe second line contains four integers a_x, a_y, b_x, and b_y (1 \u2264 a_x, b_x \u2264 n, 1 \u2264 a_y, b_y \u2264 m) \u2014 the top-left corners of the first and second sub-rectangle. Both of the sub-rectangles given are inside the grid (1 \u2264 a_x + r - 1, b_x + r - 1 \u2264 n, 1 \u2264 a_y + c - 1, b_y + c - 1 \u2264 m).\n\nOutput\n\nOutput an integer denoting the number of possible batik color combinations modulo 10^9 + 7.\n\nExamples\n\nInput\n\n\n3 3 2 2 2\n1 1 2 2\n\n\nOutput\n\n\n32\n\n\nInput\n\n\n4 5 170845 2 2\n1 4 3 1\n\n\nOutput\n\n\n756680455\n\nNote\n\nThe following are all 32 possible color combinations in the first example.\n\n<image>\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import Tuple\n\ndef solve(\n    n: int, m: int, k: int, r: int, c: int,\n    a_x: int, a_y: int, b_x: int, b_y: int\n) -> int:\n    MOD = 10 ** 9 + 7\n\n    dx = b_x - a_x\n    dy = b_y - a_y\n\n    overlap = 0\n    for i in range(r):\n        for j in range(c):\n            # The pair (i, j) in first subrect corresponds to (i + dx, j + dy) in second subrect\n            if 0 <= i + dx < r and 0 <= j + dy < c:\n                overlap += 1\n\n    total_cells = 2 * r * c - overlap\n    ans = pow(k, total_cells, MOD)\n    return ans\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "4 5 170845 2 2\n1 4 3 1\n",
            "expected_output": "756680455\n",
            "actual_output": "125218784",
            "passed": true,
            "error": null
          },
          {
            "test_index": 1,
            "input": "3 3 2 2 2\n1 1 2 2\n",
            "expected_output": "32\n",
            "actual_output": "128",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "4 5 170845 2 2\n1 4 3 1\n",
          "expected_output": "756680455\n",
          "actual_output": "125218784",
          "passed": true,
          "error": null
        },
        {
          "test_index": 1,
          "input": "3 3 2 2 2\n1 1 2 2\n",
          "expected_output": "32\n",
          "actual_output": "128",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 12,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nMr. Chanek gives you a sequence a indexed from 1 to n. Define f(a) as the number of indices where a_i = i. \n\nYou can pick an element from the current sequence and remove it, then concatenate the remaining elements together. For example, if you remove the 3-rd element from the sequence [4, 2, 3, 1], the resulting sequence will be [4, 2, 1]. \n\nYou want to remove some elements from a in order to maximize f(a), using zero or more operations. Find the largest possible f(a).\n\nInput\n\nThe first line contains one integer n (1 \u2264 n \u2264 2 \u22c5 10^5) \u2014 the initial length of the sequence.\n\nThe second line contains n integers a_1, a_2, \u2026, a_n (1 \u2264 a_i \u2264 2 \u22c5 10^5) \u2014 the initial sequence a.\n\nOutput\n\nOutput an integer denoting the largest f(a) that can be obtained by doing zero or more operations.\n\nExamples\n\nInput\n\n\n7\n2 1 4 2 5 3 7\n\n\nOutput\n\n\n3\n\n\nInput\n\n\n4\n4 2 3 1\n\n\nOutput\n\n\n2\n\nNote\n\nIn the first example, f(A) = 3 by doing the following operations.\n\n[2,1,4,2,5,3,7] \u2192 [2,1,2,5,3,7] \u2192 [1,2,5,3,7] \u2192 [1,2,5,3] \u2192 [1,2,3]\n\nIn the second example, f(A) = 2 and no additional operation is needed.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List\n\ndef solve(n: int, a: List[int]) -> int:\n    dp = dict()\n    max_f = 0\n    for num in a:\n        prev = dp.get(num - 1, 0)\n        dp[num] = prev + 1\n        if dp[num] > max_f:\n            max_f = dp[num]\n    return max_f\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "4\n4 2 3 1\n",
            "expected_output": "2\n",
            "actual_output": "2",
            "passed": true,
            "error": null
          },
          {
            "test_index": 1,
            "input": "7\n2 1 4 2 5 3 7\n",
            "expected_output": "3\n",
            "actual_output": "3",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "4\n4 2 3 1\n",
          "expected_output": "2\n",
          "actual_output": "2",
          "passed": true,
          "error": null
        },
        {
          "test_index": 1,
          "input": "7\n2 1 4 2 5 3 7\n",
          "expected_output": "3\n",
          "actual_output": "3",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 13,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nMr. Chanek's city can be represented as a plane. He wants to build a housing complex in the city.\n\nThere are some telephone poles on the plane, which is represented by a grid a of size (n + 1) \u00d7 (m + 1). There is a telephone pole at (x, y) if a_{x, y} = 1.\n\nFor each point (x, y), define S(x, y) as the square of the Euclidean distance between the nearest pole and (x, y). Formally, the square of the Euclidean distance between two points (x_1, y_1) and (x_2, y_2) is (x_2 - x_1)^2 + (y_2 - y_1)^2.\n\nTo optimize the building plan, the project supervisor asks you the sum of all S(x, y) for each 0 \u2264 x \u2264 n and 0 \u2264 y \u2264 m. Help him by finding the value of \u2211_{x=0}^{n} {\u2211_{y=0}^{m} {S(x, y)}}.\n\nInput\n\nThe first line contains two integers n and m (0 \u2264 n, m < 2000) \u2014 the size of the grid.\n\nThen (n + 1) lines follow, each containing (m + 1) integers a_{i, j} (0 \u2264 a_{i, j} \u2264 1) \u2014 the grid denoting the positions of telephone poles in the plane. There is at least one telephone pole in the given grid.\n\nOutput\n\nOutput an integer denoting the value of \u2211_{x=0}^{n} {\u2211_{y=0}^{m} {S(x, y)}}.\n\nExamples\n\nInput\n\n\n2 2\n101\n000\n000\n\n\nOutput\n\n\n18\n\n\nInput\n\n\n5 4\n10010\n00000\n01000\n00001\n00100\n00010\n\n\nOutput\n\n\n36\n\nNote\n\n<image>\n\nIn the first example, the nearest telephone pole for the points (0,0), (1,0), (2,0), (0,1), (1,1), and (2,1) is at (0, 0). While the nearest telephone pole for the points (0, 2), (1,2), and (2,2) is at (0, 2). Thus, \u2211_{x=0}^{n} {\u2211_{y=0}^{m} {S(x, y)}} = (0 + 1 + 4) + (1 + 2 + 5) + (0 + 1 + 4) = 18.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List\nfrom collections import deque\n\ndef solve(n: int, m: int, a: List[List[int]]) -> int:\n    INF = 2 * (max(n, m) + 1) ** 2\n    dist = [[INF] * (m + 1) for _ in range(n + 1)]\n    for i in range(n + 1):\n        for j in range(m + 1):\n            if a[i][j]:\n                dist[i][j] = 0\n\n    # 1st pass: horizontal 1D squared distance transform per row\n    for x in range(n + 1):\n        f = [INF] * (m + 1)\n        for y in range(m + 1):\n            if a[x][y]: f[y]=0\n        q = []\n        pos = []\n        for y in range(m + 1):\n            # compute parabola lower envelope\n            if not q:\n                q.append(f[y])\n                pos.append(y)\n            else:\n                while len(q) >= 2:\n                    y1, y2 = pos[-2], pos[-1]\n                    s1, s2 = q[-2], q[-1]\n                    # intersection along y is where (s1 + (y-y1)^2) = (s2 + (y-y2)^2)\n                    cross1 = ((s2 - s1) + y2*y2 - y1*y1 + 2*y*(y1-y2)) / (2*(y1 - y2)) if (y1-y2)!=0 else -INF\n                    cross2 = ((f[y] - q[-1]) + y*y - y2*y2 + 2*y2*(y2-y)) / (2*(y2 - y)) if (y2 - y)!=0 else -INF\n                    if cross2 <= cross1:\n                        q.pop()\n                        pos.pop()\n                    else:\n                        break\n                q.append(f[y])\n                pos.append(y)\n        # forward pass\n        d = [INF] * (m + 1)\n        k = 0\n        for y in range(m + 1):\n            while k + 1 < len(pos) and (y - pos[k])**2 + q[k] > (y - pos[k+1])**2 + q[k+1]:\n                k += 1\n            d[y] = (y - pos[k])**2 + q[k]\n        # backward pass\n        fwd = [INF] * (m + 1)\n        q = []\n        pos = []\n        for y in range(m, -1, -1):\n            if not q:\n                q.append(f[y])\n                pos.append(y)\n            else:\n                while len(q) >= 2:\n                    y1, y2 = pos[-2], pos[-1]\n                    s1, s2 = q[-2], q[-1]\n                    cross1 = ((s2 - s1) + y2*y2 - y1*y1 + 2*y*(y1-y2)) / (2*(y1 - y2)) if (y1-y2)!=0 else -INF\n                    cross2 = ((f[y] - q[-1]) + y*y - y2*y2 + 2*y2*(y2-y)) / (2*(y2 - y)) if (y2-y)!=0 else -INF\n                    if cross2 <= cross1:\n                        q.pop()\n                        pos.pop()\n                    else:\n                        break\n                q.append(f[y])\n                pos.append(y)\n        # backward pass\n        k = 0\n        for y in range(m, -1, -1):\n            while k + 1 < len(pos) and (y - pos[k])**2 + q[k] > (y - pos[k+1])**2 + q[k+1]:\n                k += 1\n            fwd[y] = (y - pos[k])**2 + q[k]\n        # take min\n        for y in range(m+1):\n            dist[x][y] = d[y] if d[y]<fwd[y] else fwd[y]\n\n    # 2nd pass: vertical 1D squared distance transform per column\n    for y in range(m + 1):\n        f = [dist[x][y] for x in range(n + 1)]\n        q = []\n        pos = []\n        for x in range(n + 1):\n            if not q:\n                q.append(f[x])\n                pos.append(x)\n            else:\n                while len(q) >= 2:\n                    x1, x2 = pos[-2], pos[-1]\n                    s1, s2 = q[-2], q[-1]\n                    cross1 = ((s2 - s1) + x2*x2 - x1*x1 + 2*x*(x1-x2)) / (2*(x1 - x2)) if (x1-x2)!=0 else -INF\n                    cross2 = ((f[x] - q[-1]) + x*x - x2*x2 + 2*x2*(x2-x)) / (2*(x2 - x)) if (x2-x)!=0 else -INF\n                    if cross2 <= cross1:\n                        q.pop()\n                        pos.pop()\n                    else:\n                        break\n                q.append(f[x])\n                pos.append(x)\n        d = [INF]*(n+1)\n        k = 0\n        for x in range(n + 1):\n            while k + 1 < len(pos) and (x - pos[k])**2 + q[k] > (x - pos[k+1])**2 + q[k+1]:\n                k += 1\n            d[x] = (x - pos[k])**2 + q[k]\n        # backward\n        q2 = []\n        pos2 = []\n        fwd = [INF] * (n+1)\n        for x in range(n, -1, -1):\n            if not q2:\n                q2.append(f[x])\n                pos2.append(x)\n            else:\n                while len(q2) >= 2:\n                    x1, x2 = pos2[-2], pos2[-1]\n                    s1, s2 = q2[-2], q2[-1]\n                    cross1 = ((s2 - s1) + x2*x2 - x1*x1 + 2*x*(x1-x2)) / (2*(x1 - x2)) if (x1-x2)!=0 else -INF\n                    cross2 = ((f[x] - q2[-1]) + x*x - x2*x2 + 2*x2*(x2-x)) / (2*(x2 - x)) if (x2-x)!=0 else -INF\n                    if cross2 <= cross1:\n                        q2.pop()\n                        pos2.pop()\n                    else:\n                        break\n                q2.append(f[x])\n                pos2.append(x)\n        k = 0\n        for x in range(n, -1, -1):\n            while k + 1 < len(pos2) and (x - pos2[k])**2 + q2[k] > (x - pos2[k+1])**2 + q2[k+1]:\n                k += 1\n            fwd[x] = (x - pos2[k])**2 + q2[k]\n        for x in range(n+1):\n            dist[x][y] = d[x] if d[x]<fwd[x] else fwd[x]\n\n    return sum(sum(row) for row in dist)\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "2 2\n101\n000\n000\n",
            "expected_output": "18\n",
            "actual_output": "18",
            "passed": true,
            "error": null
          },
          {
            "test_index": 1,
            "input": "5 4\n10010\n00000\n01000\n00001\n00100\n00010\n",
            "expected_output": "36\n",
            "actual_output": "36",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "2 2\n101\n000\n000\n",
          "expected_output": "18\n",
          "actual_output": "18",
          "passed": true,
          "error": null
        },
        {
          "test_index": 1,
          "input": "5 4\n10010\n00000\n01000\n00001\n00100\n00010\n",
          "expected_output": "36\n",
          "actual_output": "36",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 14,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nCasimir has a string s which consists of capital Latin letters 'A', 'B', and 'C' only. Each turn he can choose to do one of the two following actions:\n\n  * he can either erase exactly one letter 'A' and exactly one letter 'B' from arbitrary places of the string (these letters don't have to be adjacent); \n  * or he can erase exactly one letter 'B' and exactly one letter 'C' from arbitrary places in the string (these letters don't have to be adjacent). \n\n\n\nTherefore, each turn the length of the string is decreased exactly by 2. All turns are independent so for each turn, Casimir can choose any of two possible actions.\n\nFor example, with s = \"ABCABC\" he can obtain a string s = \"ACBC\" in one turn (by erasing the first occurrence of 'B' and the second occurrence of 'A'). There are also many other options for a turn aside from this particular example.\n\nFor a given string s determine whether there is a sequence of actions leading to an empty string. In other words, Casimir's goal is to erase all letters from the string. Is there a way to do this?\n\nInput\n\nThe first line contains an integer t (1 \u2264 t \u2264 1000) \u2014 the number of test cases.\n\nEach test case is described by one string s, for which you need to determine if it can be fully erased by some sequence of turns. The string s consists of capital letters 'A', 'B', 'C' and has a length from 1 to 50 letters, inclusive.\n\nOutput\n\nPrint t lines, each line containing the answer to the corresponding test case. The answer to a test case should be YES if there is a way to fully erase the corresponding string and NO otherwise.\n\nYou may print every letter in any case you want (so, for example, the strings yEs, yes, Yes, and YES will all be recognized as positive answers).\n\nExample\n\nInput\n\n\n6\nABACAB\nABBA\nAC\nABC\nCABCBB\nBCBCBCBCBCBCBCBC\n\n\nOutput\n\n\nNO\nYES\nNO\nNO\nYES\nYES\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List\n\ndef solve(t: int, test_cases: List[str]) -> List[str]:\n    res = []\n    for s in test_cases:\n        na = s.count('A')\n        nb = s.count('B')\n        nc = s.count('C')\n        if nb == na + nc and (nb - na) >= 0 and (nb - nc) >= 0:\n            res.append(\"YES\")\n        else:\n            res.append(\"NO\")\n    return res\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "6\nABACAB\nABBA\nAC\nABC\nCABCBB\nBCBCBCBCBCBCBCBC\n",
            "expected_output": "NO\nYES\nNO\nNO\nYES\nYES\n",
            "actual_output": "['NO', 'YES', 'NO', 'NO', 'YES', 'YES']",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "6\nABACAB\nABBA\nAC\nABC\nCABCBB\nBCBCBCBCBCBCBCBC\n",
          "expected_output": "NO\nYES\nNO\nNO\nYES\nYES\n",
          "actual_output": "['NO', 'YES', 'NO', 'NO', 'YES', 'YES']",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 15,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nThe new generation external memory contains an array of integers a[1 \u2026 n] = [a_1, a_2, \u2026, a_n].\n\nThis type of memory does not support changing the value of an arbitrary element. Instead, it allows you to cut out any segment of the given array, cyclically shift (rotate) it by any offset and insert it back into the same place.\n\nTechnically, each cyclic shift consists of two consecutive actions: \n\n  1. You may select arbitrary indices l and r (1 \u2264 l < r \u2264 n) as the boundaries of the segment. \n  2. Then you replace the segment a[l \u2026 r] with it's cyclic shift to the left by an arbitrary offset d. The concept of a cyclic shift can be also explained by following relations: the sequence [1, 4, 1, 3] is a cyclic shift of the sequence [3, 1, 4, 1] to the left by the offset 1 and the sequence [4, 1, 3, 1] is a cyclic shift of the sequence [3, 1, 4, 1] to the left by the offset 2. \n\n\n\nFor example, if a = [1, \\color{blue}{3, 2, 8}, 5], then choosing l = 2, r = 4 and d = 2 yields a segment a[2 \u2026 4] = [3, 2, 8]. This segment is then shifted by the offset d = 2 to the left, and you get a segment [8, 3, 2] which then takes the place of of the original elements of the segment. In the end you get a = [1, \\color{blue}{8, 3, 2}, 5].\n\nSort the given array a using no more than n cyclic shifts of any of its segments. Note that you don't need to minimize the number of cyclic shifts. Any method that requires n or less cyclic shifts will be accepted.\n\nInput\n\nThe first line contains an integer t (1 \u2264 t \u2264 1000) \u2014 the number of test cases.\n\nThe next 2t lines contain the descriptions of the test cases. \n\nThe first line of each test case description contains an integer n (2 \u2264 n \u2264 50) \u2014 the length of the array. The second line consists of space-separated elements of the array a_i (-10^9 \u2264 a_i \u2264 10^9). Elements of array a may repeat and don't have to be unique.\n\nOutput\n\nPrint t answers to all input test cases. \n\nThe first line of the answer of each test case should contain an integer k (0 \u2264 k \u2264 n) \u2014 the number of actions to sort the array. The next k lines should contain descriptions of the actions formatted as \"l r d\" (without quotes) where l and r (1 \u2264 l < r \u2264 n) are the boundaries of the segment being shifted, while d (1 \u2264 d \u2264 r - l) is the offset value. Please remember that only the cyclic shifts to the left are considered so the chosen segment will be shifted by the offset d to the to the left.\n\nNote that you are not required to find the minimum number of cyclic shifts needed for sorting. Any sorting method where the number of shifts does not exceed n will be accepted.\n\nIf the given array a is already sorted, one of the possible answers is k = 0 and an empty sequence of cyclic shifts.\n\nIf there are several possible answers, you may print any of them.\n\nExample\n\nInput\n\n\n4\n2\n2 1\n3\n1 2 1\n4\n2 4 1 3\n5\n2 5 1 4 3\n\n\nOutput\n\n\n1\n1 2 1\n1\n1 3 2\n3\n2 4 1\n2 3 1\n1 3 2\n4\n2 4 2\n1 5 3\n1 2 1\n1 3 1\n\nNote\n\nExplanation of the fourth data set in the example: \n\n  1. The segment a[2 \u2026 4] is selected and is shifted to the left by 2: [2, \\color{blue}{5, 1, 4}, 3] \\longrightarrow [2, \\color{blue}{4, 5, 1}, 3] \n  2. The segment a[1 \u2026 5] is then selected and is shifted to the left by 3: [\\color{blue}{2, 4, 5, 1, 3}] \\longrightarrow [\\color{blue}{1, 3, 2, 4, 5}] \n  3. After that the segment a[1 \u2026 2] is selected and is shifted to the left by 1: [\\color{blue}{1, 3}, 2, 4, 5] \\longrightarrow [\\color{blue}{3, 1}, 2, 4, 5] \n  4. And in the end the segment a[1 \u2026 3] is selected and is shifted to the left by 1: [\\color{blue}{3, 1, 2}, 4, 5] \\longrightarrow [\\color{blue}{1, 2, 3}, 4, 5]\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List, Tuple\n\ndef solve(t: int, testcases: List[Tuple[int, List[int]]]) -> List[str]:\n    res = []\n    for n, a in testcases:\n        b = list(a)\n        sorted_a = sorted(a)\n        ops = []\n        arr = list(a)\n        for i in range(n):\n            if arr[i] != sorted_a[i]:\n                # Find the position of sorted_a[i] in arr, starting from i\n                j = i\n                while j < n and arr[j] != sorted_a[i]:\n                    j += 1\n                if j == n:\n                    continue # should not happen\n                d = j - i\n                # We want to move arr[j] to arr[i]\n                # So, cyclic shift arr[i:j+1] by d\n                if d > 0:\n                    l = i + 1\n                    r = j + 1\n                    shift = d\n                    ops.append(f\"{l} {r} {shift}\")\n                    # Apply the shift\n                    seg = arr[i:r]\n                    seg = seg[shift:] + seg[:shift]\n                    arr[i:r] = seg\n        res.append(str(len(ops)))\n        res.extend(ops)\n    return res\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "4\n2\n2 1\n3\n1 2 1\n4\n2 4 1 3\n5\n2 5 1 4 3\n",
            "expected_output": "1\n1 2 1\n1\n2 3 1\n2\n1 3 2\n3 4 1\n3\n1 3 2\n3 5 2\n4 5 1\n",
            "actual_output": "['1', '1 2 1', '1', '2 3 1', '2', '1 3 2', '3 4 1', '3', '1 3 2', '3 5 2', '4 5 1']",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "4\n2\n2 1\n3\n1 2 1\n4\n2 4 1 3\n5\n2 5 1 4 3\n",
          "expected_output": "1\n1 2 1\n1\n2 3 1\n2\n1 3 2\n3 4 1\n3\n1 3 2\n3 5 2\n4 5 1\n",
          "actual_output": "['1', '1 2 1', '1', '2 3 1', '2', '1 3 2', '3 4 1', '3', '1 3 2', '3 5 2', '4 5 1']",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 16,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nCasimir has a rectangular piece of paper with a checkered field of size n \u00d7 m. Initially, all cells of the field are white.\n\nLet us denote the cell with coordinates i vertically and j horizontally by (i, j). The upper left cell will be referred to as (1, 1) and the lower right cell as (n, m).\n\nCasimir draws ticks of different sizes on the field. A tick of size d (d > 0) with its center in cell (i, j) is drawn as follows: \n\n  1. First, the center cell (i, j) is painted black. \n  2. Then exactly d cells on the top-left diagonally to the center and exactly d cells on the top-right diagonally to the center are also painted black. \n  3. That is all the cells with coordinates (i - h, j \u00b1 h) for all h between 0 and d are painted. In particular, a tick consists of 2d + 1 black cells. \n\n\n\nAn already painted cell will remain black if painted again. Below you can find an example of the 4 \u00d7 9 box, with two ticks of sizes 2 and 3.\n\n<image>\n\nYou are given a description of a checkered field of size n \u00d7 m. Casimir claims that this field came about after he drew some (possibly 0) ticks on it. The ticks could be of different sizes, but the size of each tick is at least k (that is, d \u2265 k for all the ticks).\n\nDetermine whether this field can indeed be obtained by drawing some (possibly none) ticks of sizes d \u2265 k or not.\n\nInput\n\nThe first line contains an integer t (1 \u2264 t \u2264 100) \u2014 the number test cases.\n\nThe following lines contain the descriptions of the test cases. \n\nThe first line of the test case description contains the integers n, m, and k (1 \u2264 k \u2264 n \u2264 10; 1 \u2264 m \u2264 19) \u2014 the field size and the minimum size of the ticks that Casimir drew. The following n lines describe the field: each line consists of m characters either being '.' if the corresponding cell is not yet painted or '*' otherwise.\n\nOutput\n\nPrint t lines, each line containing the answer to the corresponding test case. The answer to a test case should be YES if the given field can be obtained by drawing ticks of at least the given size and NO otherwise.\n\nYou may print every letter in any case you want (so, for example, the strings yEs, yes, Yes, and YES will all be recognized as positive answers).\n\nExample\n\nInput\n\n\n8\n2 3 1\n*.*\n...\n4 9 2\n*.*.*...*\n.*.*...*.\n..*.*.*..\n.....*...\n4 4 1\n*.*.\n****\n.**.\n....\n5 5 1\n.....\n*...*\n.*.*.\n..*.*\n...*.\n5 5 2\n.....\n*...*\n.*.*.\n..*.*\n...*.\n4 7 1\n*.....*\n.....*.\n..*.*..\n...*...\n3 3 1\n***\n***\n***\n3 5 1\n*...*\n.***.\n.**..\n\n\nOutput\n\n\nNO\nYES\nYES\nYES\nNO\nNO\nNO\nNO\n\nNote\n\nThe first sample test case consists of two asterisks neither of which can be independent ticks since ticks of size 0 don't exist.\n\nThe second sample test case is already described in the statement (check the picture in the statement). This field can be obtained by drawing ticks of sizes 2 and 3, as shown in the figure.\n\nThe field in the third sample test case corresponds to three ticks of size 1. Their center cells are marked with \\color{blue}{blue}, \\color{red}{red} and \\color{green}{green} colors: *.*.  \n---  \n*\\color{blue}{*}**  \n.\\color{green}{*}\\color{red}{*}.  \n....  \n  \nThe field in the fourth sample test case could have been obtained by drawing two ticks of sizes 1 and 2. Their vertices are marked below with \\color{blue}{blue} and \\color{red}{red} colors respectively: .....  \n---  \n*...*  \n.*.*.  \n..\\color{red}{*}.*  \n...\\color{blue}{*}.  \n  \nThe field in the fifth sample test case can not be obtained because k = 2, and the last asterisk in the fourth row from the top with coordinates (4, 5) can only be a part of a tick of size 1.\n\nThe field in the sixth sample test case can not be obtained because the top left asterisk (1, 1) can't be an independent tick, since the sizes of the ticks must be positive, and cannot be part of a tick with the center cell in the last row, since it is separated from it by a gap (a point, '.') in (2, 2).\n\nIn the seventh sample test case, similarly, the field can not be obtained by the described process because the asterisks with coordinates (1, 2) (second cell in the first row), (3, 1) and (3, 3) (leftmost and rightmost cells in the bottom) can not be parts of any ticks.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List, Tuple\n\ndef solve() -> None:\n    import sys\n    input = sys.stdin.read\n    data = input().splitlines()\n    t = int(data[0])\n    idx = 1\n    res = []\n    for _ in range(t):\n        n, m, k = map(int, data[idx].split())\n        idx += 1\n        field = [list(data[idx + i]) for i in range(n)]\n        idx += n\n\n        cover = [[False]*m for _ in range(n)]\n        # From bottom to top, right to left\n        for i in range(n-1, -1, -1):\n            for j in range(m):\n                if field[i][j] != '*':\n                    continue\n                cnt = 0\n                d = 1\n                while True:\n                    x1 = i - d\n                    y1 = j - d\n                    x2 = i - d\n                    y2 = j + d\n                    if x1 < 0 or y1 < 0 or y2 >= m:\n                        break\n                    if field[x1][y1] == '*' and field[x2][y2] == '*':\n                        cnt += 1\n                        d += 1\n                    else:\n                        break\n                if cnt >= k:\n                    for h in range(cnt+1):\n                        cover[i - h][j - h] = True\n                        cover[i - h][j + h] = True\n\n        ok = True\n        for i in range(n):\n            for j in range(m):\n                if field[i][j] == '*' and not cover[i][j]:\n                    ok = False\n        res.append(\"YES\" if ok else \"NO\")\n    print('\\n'.join(res))\n```",
    "ground_truth": "",
    "score": {
      "correct": false,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "8\n2 3 1\n*.*\n...\n4 9 2\n*.*.*...*\n.*.*...*.\n..*.*.*..\n.....*...\n4 4 1\n*.*.\n****\n.**.\n....\n5 5 1\n.....\n*...*\n.*.*.\n..*.*\n...*.\n5 5 2\n.....\n*...*\n.*.*.\n..*.*\n...*.\n4 7 1\n*.....*\n.....*.\n..*.*..\n...*...\n3 3 1\n***\n***\n***\n3 5 1\n*...*\n.***.\n.**..\n",
            "expected_output": "NO\nYES\nYES\nYES\nNO\nNO\nNO\nNO\n",
            "actual_output": "ERROR: File \"<string>\", line 87\n    import sys\n    ^^^^^^\nSyntaxError: invalid syntax",
            "passed": false,
            "error": "File \"<string>\", line 87\n    import sys\n    ^^^^^^\nSyntaxError: invalid syntax"
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "8\n2 3 1\n*.*\n...\n4 9 2\n*.*.*...*\n.*.*...*.\n..*.*.*..\n.....*...\n4 4 1\n*.*.\n****\n.**.\n....\n5 5 1\n.....\n*...*\n.*.*.\n..*.*\n...*.\n5 5 2\n.....\n*...*\n.*.*.\n..*.*\n...*.\n4 7 1\n*.....*\n.....*.\n..*.*..\n...*...\n3 3 1\n***\n***\n***\n3 5 1\n*...*\n.***.\n.**..\n",
          "expected_output": "NO\nYES\nYES\nYES\nNO\nNO\nNO\nNO\n",
          "actual_output": "ERROR: File \"<string>\", line 87\n    import sys\n    ^^^^^^\nSyntaxError: invalid syntax",
          "passed": false,
          "error": "File \"<string>\", line 87\n    import sys\n    ^^^^^^\nSyntaxError: invalid syntax"
        }
      ]
    }
  },
  {
    "sample_id": 17,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nAn important meeting is to be held and there are exactly n people invited. At any moment, any two people can step back and talk in private. The same two people can talk several (as many as they want) times per meeting.\n\nEach person has limited sociability. The sociability of the i-th person is a non-negative integer a_i. This means that after exactly a_i talks this person leaves the meeting (and does not talk to anyone else anymore). If a_i = 0, the i-th person leaves the meeting immediately after it starts.\n\nA meeting is considered most productive if the maximum possible number of talks took place during it.\n\nYou are given an array of sociability a, determine which people should talk to each other so that the total number of talks is as large as possible.\n\nInput\n\nThe first line contains an integer t (1 \u2264 t \u2264 1000) \u2014 the number of test cases.\n\nThe next 2t lines contain descriptions of the test cases.\n\nThe first line of each test case description contains an integer n (2 \u2264 n \u2264 2 \u22c5 10^5) \u2014the number of people in the meeting. The second line consists of n space-separated integers a_1, a_2, ..., a_n (0 \u2264 a_i \u2264 2 \u22c5 10^5) \u2014 the sociability parameters of all people. \n\nIt is guaranteed that the sum of n over all test cases does not exceed 2 \u22c5 10^5. It is also guaranteed that the sum of all a_i (over all test cases and all i) does not exceed 2 \u22c5 10^5.\n\nOutput\n\nPrint t answers to all test cases.\n\nOn the first line of each answer print the number k \u2014 the maximum number of talks possible in a meeting.\n\nOn each of the next k lines print two integers i and j (1 \u2264 i, j \u2264 n and i \u2260 j) \u2014 the numbers of people who will have another talk.\n\nIf there are several possible answers, you may print any of them.\n\nExample\n\nInput\n\n\n8\n2\n2 3\n3\n1 2 3\n4\n1 2 3 4\n3\n0 0 2\n2\n6 2\n3\n0 0 2\n5\n8 2 0 1 1\n5\n0 1 0 0 6\n\n\nOutput\n\n\n2\n1 2\n1 2\n3\n1 3\n2 3\n2 3\n5\n1 3\n2 4\n2 4\n3 4\n3 4\n0\n2\n1 2\n1 2\n0\n4\n1 2\n1 5\n1 4\n1 2\n1\n5 2\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List, Tuple\nimport heapq\n\ndef solve(t: int, testcases: List[Tuple[int, List[int]]]) -> List[List[str]]:\n    res = []\n    for n, a in testcases:\n        heap = []\n        for idx, val in enumerate(a):\n            if val > 0:\n                heapq.heappush(heap, (-val, idx+1))\n        talks = []\n        while len(heap) >= 2:\n            val1, idx1 = heapq.heappop(heap)\n            val2, idx2 = heapq.heappop(heap)\n            talks.append(f\"{idx1} {idx2}\")\n            if val1 + 1 < 0:\n                heapq.heappush(heap, (val1+1, idx1))\n            if val2 + 1 < 0:\n                heapq.heappush(heap, (val2+1, idx2))\n        ans = [str(len(talks))]\n        ans += talks\n        res.append(ans)\n    return res\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "8\n2\n2 3\n3\n1 2 3\n4\n1 2 3 4\n3\n0 0 2\n2\n6 2\n3\n0 0 2\n5\n8 2 0 1 1\n5\n0 1 0 0 6\n",
            "expected_output": "2\n2 1\n2 1\n3\n3 2\n3 1\n2 3\n5\n4 3\n4 2\n3 4\n1 2\n3 4\n0\n2\n1 2\n1 2\n0\n4\n1 2\n1 2\n1 4\n1 5\n1\n5 2\n",
            "actual_output": "[['2', '2 1', '2 1'], ['3', '3 2', '3 1', '2 3'], ['5', '4 3', '4 2', '3 4', '1 2', '3 4'], ['0'], ['2', '1 2', '1 2'], ['0'], ['4', '1 2', '1 2', '1 4', '1 5'], ['1', '5 2']]",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "8\n2\n2 3\n3\n1 2 3\n4\n1 2 3 4\n3\n0 0 2\n2\n6 2\n3\n0 0 2\n5\n8 2 0 1 1\n5\n0 1 0 0 6\n",
          "expected_output": "2\n2 1\n2 1\n3\n3 2\n3 1\n2 3\n5\n4 3\n4 2\n3 4\n1 2\n3 4\n0\n2\n1 2\n1 2\n0\n4\n1 2\n1 2\n1 4\n1 5\n1\n5 2\n",
          "actual_output": "[['2', '2 1', '2 1'], ['3', '3 2', '3 1', '2 3'], ['5', '4 3', '4 2', '3 4', '1 2', '3 4'], ['0'], ['2', '1 2', '1 2'], ['0'], ['4', '1 2', '1 2', '1 4', '1 5'], ['1', '5 2']]",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 18,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nIn fact, the problems E1 and E2 do not have much in common. You should probably think of them as two separate problems.\n\nYou are given an integer array a[1 \u2026 n] = [a_1, a_2, \u2026, a_n].\n\nLet us consider an empty [deque](https://tinyurl.com/pfeucbux) (double-ended queue). A deque is a data structure that supports adding elements to both the beginning and the end. So, if there are elements [3, 4, 4] currently in the deque, adding an element 1 to the beginning will produce the sequence [\\color{red}{1}, 3, 4, 4], and adding the same element to the end will produce [3, 4, 4, \\color{red}{1}].\n\nThe elements of the array are sequentially added to the initially empty deque, starting with a_1 and finishing with a_n. Before adding each element to the deque, you may choose whether to add it to the beginning or to the end.\n\nFor example, if we consider an array a = [3, 7, 5, 5], one of the possible sequences of actions looks like this:    1. |  add 3 to the beginning of the deque: |  deque has a sequence [\\color{red}{3}] in it;   \n---|---|---  \n  2. |  add 7 to the end of the deque: |  deque has a sequence [3, \\color{red}{7}] in it;   \n  3. |  add 5 to the end of the deque: |  deque has a sequence [3, 7, \\color{red}{5}] in it;   \n  4. |  add 5 to the beginning of the deque: |  deque has a sequence [\\color{red}{5}, 3, 7, 5] in it;   \n  \nFind the minimal possible number of inversions in the deque after the whole array is processed. \n\nAn inversion in sequence d is a pair of indices (i, j) such that i < j and d_i > d_j. For example, the array d = [5, 3, 7, 5] has exactly two inversions \u2014 (1, 2) and (3, 4), since d_1 = 5 > 3 = d_2 and d_3 = 7 > 5 = d_4.\n\nInput\n\nThe first line contains an integer t (1 \u2264 t \u2264 1000) \u2014 the number of test cases.\n\nThe next 2t lines contain descriptions of the test cases. \n\nThe first line of each test case description contains an integer n (1 \u2264 n \u2264 2 \u22c5 10^5) \u2014 array size. The second line of the description contains n space-separated integers a_i (-10^9 \u2264 a_i \u2264 10^9) \u2014 elements of the array.\n\nIt is guaranteed that the sum of n over all test cases does not exceed 2 \u22c5 10^5.\n\nOutput\n\nPrint t lines, each line containing the answer to the corresponding test case. The answer to a test case should be a single integer \u2014 the minimal possible number of inversions in the deque after executing the described algorithm.\n\nExample\n\nInput\n\n\n6\n4\n3 7 5 5\n3\n3 2 1\n3\n3 1 2\n4\n-1 2 2 -1\n4\n4 5 1 3\n5\n1 3 1 3 2\n\n\nOutput\n\n\n2\n0\n1\n0\n1\n2\n\nNote\n\nOne of the ways to get the sequence [5, 3, 7, 5] in the deque, containing only two inversions, from the initial array [3, 7, 5, 5] (the first sample test case) is described in the problem statement. \n\nAlso, in this example, you could get the answer of two inversions by simply putting each element of the original array at the end of the deque. In this case, the original sequence [3, 7, 5, 5], also containing exactly two inversions, will be in the deque as-is.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List, Tuple\nimport bisect\n\ndef solve(t: int, test_cases: List[Tuple[int, List[int]]]) -> List[int]:\n    from collections import defaultdict\n\n    results = []\n\n    for n, a in test_cases:\n        # Coordinate compression\n        arr = sorted(set(a))\n        m = {v: i for i, v in enumerate(arr)}\n        max_idx = len(arr)\n        a2 = [m[x] for x in a]\n\n        dp = [ [0]*(n+1) for _ in range(n+1) ]\n        # dp[l][r] means minimal inversion count for segment a[l:r] inclusive (l elements placed to the left, rest to right)\n        # We won't store the actual deque, just inversion count.\n        # We always process in order, can only add new element to left or right end\n\n        # Instead, because the order doesn't matter except for inversion, we process by considering\n        # at each step k (0..n), the minimal inversion for all ways to pick k elements to the left, rest right (by placing them)\n        # In fact, we can use a greedy strategy; at every step, decide which causes less new inversions.\n        # That is, for each element, we can place at left or right. \n        # If we process elements in order: at current state of deque, how many elements on the left (<) and right (>) of this value if placed at front or back, respectively.\n\n        # We use BIT to keep current state.\n        class BIT:\n            def __init__(self, n):\n                self.n = n+2\n                self.tree = [0]*(self.n)\n            def add(self, i, x=1):\n                i += 1\n                while i < self.n:\n                    self.tree[i] += x\n                    i += i & -i\n            def query(self, i):\n                i += 1\n                res = 0\n                while i:\n                    res += self.tree[i]\n                    i -= i & -i\n                return res\n            def range(self, l, r):\n                return self.query(r) - self.query(l-1)\n\n        left_BIT = BIT(max_idx)\n        right_BIT = BIT(max_idx)\n\n        l, r = [], []\n\n        inv_count = 0\n        for x in a2:\n            # Count inversions if put x to left (front)\n            inv_left = left_BIT.query(max_idx-1) - left_BIT.query(x)\n            # Put x at right (back)\n            inv_right = right_BIT.query(x-1)\n            # Pick best\n            if inv_left <= inv_right:\n                inv_count += inv_left\n                left_BIT.add(x)\n            else:\n                inv_count += inv_right\n                right_BIT.add(x)\n        results.append(inv_count)\n    return results\n```",
    "ground_truth": "",
    "score": {
      "correct": false,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "6\n4\n3 7 5 5\n3\n3 2 1\n3\n3 1 2\n4\n-1 2 2 -1\n4\n4 5 1 3\n5\n1 3 1 3 2\n",
            "expected_output": "2\n0\n1\n0\n1\n2\n",
            "actual_output": "ERROR: Traceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nNameError: name 'List' is not defined. Did you mean: 'list'?",
            "passed": false,
            "error": "Traceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nNameError: name 'List' is not defined. Did you mean: 'list'?"
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "6\n4\n3 7 5 5\n3\n3 2 1\n3\n3 1 2\n4\n-1 2 2 -1\n4\n4 5 1 3\n5\n1 3 1 3 2\n",
          "expected_output": "2\n0\n1\n0\n1\n2\n",
          "actual_output": "ERROR: Traceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nNameError: name 'List' is not defined. Did you mean: 'list'?",
          "passed": false,
          "error": "Traceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nNameError: name 'List' is not defined. Did you mean: 'list'?"
        }
      ]
    }
  },
  {
    "sample_id": 19,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nYou are given an array a[0 \u2026 n - 1] = [a_0, a_1, \u2026, a_{n - 1}] of zeroes and ones only. Note that in this problem, unlike the others, the array indexes are numbered from zero, not from one.\n\nIn one step, the array a is replaced by another array of length n according to the following rules: \n\n  1. First, a new array a^{\u2192 d} is defined as a cyclic shift of the array a to the right by d cells. The elements of this array can be defined as a^{\u2192 d}_i = a_{(i + n - d) mod n}, where (i + n - d) mod n is the remainder of integer division of i + n - d by n. \n\nIt means that the whole array a^{\u2192 d} can be represented as a sequence $$$a^{\u2192 d} = [a_{n - d}, a_{n - d + 1}, \u2026, a_{n - 1}, a_0, a_1, \u2026, a_{n - d - 1}]$$$\n\n  2. Then each element of the array a_i is replaced by a_i  \\&  a^{\u2192 d}_i, where \\& is a logical \"AND\" operator. \n\n\n\nFor example, if a = [0, 0, 1, 1] and d = 1, then a^{\u2192 d} = [1, 0, 0, 1] and the value of a after the first step will be [0  \\&  1, 0  \\&  0, 1  \\&  0, 1  \\&  1], that is [0, 0, 0, 1].\n\nThe process ends when the array stops changing. For a given array a, determine whether it will consist of only zeros at the end of the process. If yes, also find the number of steps the process will take before it finishes.\n\nInput\n\nThe first line contains an integer t (1 \u2264 t \u2264 1000) \u2014 the number of test cases.\n\nThe next 2t lines contain descriptions of the test cases. \n\nThe first line of each test case description contains two integers: n (1 \u2264 n \u2264 10^6) \u2014 array size and d (1 \u2264 d \u2264 n) \u2014 cyclic shift offset. The second line of the description contains n space-separated integers a_i (0 \u2264 a_i \u2264 1) \u2014 elements of the array.\n\nIt is guaranteed that the sum of n over all test cases does not exceed 10^6.\n\nOutput\n\nPrint t lines, each line containing the answer to the corresponding test case. The answer to a test case should be a single integer \u2014 the number of steps after which the array will contain only zeros for the first time. If there are still elements equal to 1 in the array after the end of the process, print -1.\n\nExample\n\nInput\n\n\n5\n2 1\n0 1\n3 2\n0 1 0\n5 2\n1 1 0 1 0\n4 2\n0 1 0 1\n1 1\n0\n\n\nOutput\n\n\n1\n1\n3\n-1\n0\n\nNote\n\nIn the third sample test case the array will change as follows: \n\n  1. At the beginning a = [1, 1, 0, 1, 0], and a^{\u2192 2} = [1, 0, 1, 1, 0]. Their element-by-element \"AND\" is equal to $$$[1  \\&  1, 1  \\&  0, 0  \\&  1, 1  \\&  1, 0  \\&  0] = [1, 0, 0, 1, 0]$$$ \n  2. Now a = [1, 0, 0, 1, 0], then a^{\u2192 2} = [1, 0, 1, 0, 0]. Their element-by-element \"AND\" equals to $$$[1  \\&  1, 0  \\&  0, 0  \\&  1, 1  \\&  0, 0  \\&  0] = [1, 0, 0, 0, 0]$$$ \n  3. And finally, when a = [1, 0, 0, 0, 0] we get a^{\u2192 2} = [0, 0, 1, 0, 0]. Their element-by-element \"AND\" equals to $$$[1  \\&  0, 0  \\&  0, 0  \\&  1, 0  \\&  0, 0  \\&  0] = [0, 0, 0, 0, 0]$$$ \n\nThus, the answer is 3 steps.\n\nIn the fourth sample test case, the array will not change as it shifts by 2 to the right, so each element will be calculated as 0  \\&  0 or 1  \\&  1 thus not changing its value. So the answer is -1, the array will never contain only zeros.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List, Tuple\nfrom math import gcd\n\ndef solve(t: int, testcases: List[Tuple[int, int, List[int]]]) -> List[int]:\n    res = []\n    for n, d, a in testcases:\n        if all(x == 0 for x in a):\n            res.append(0)\n            continue\n        g = gcd(n, d)\n        answer = 0\n        fail = False\n        visited = [False]*n\n        for start in range(g):\n            i = start\n            cnt = 0\n            seg = []\n            first = True\n            while True:\n                seg.append(a[i])\n                i = (i + d) % n\n                if i == start:\n                    break\n            # Now seg is the cycle\n            # Find the longest consecutive 1-segment, considering wrapping around\n            # because after each step, the corresponding AND is 1 only if both elements are 1\n            # i.e., if the segment is broken by 0, that cuts progression.\n            # If there's no zero, then this cycle will never die (perpetual 1s).\n            # Since array is circular, check wrap-around.\n            l = len(seg)\n            if 0 not in seg:\n                fail = True\n                break\n            # For circular max segment, duplicate seg\n            seg2 = seg + seg\n            max_ones = 0\n            cur = 0\n            for val in seg2:\n                if val == 1:\n                    cur += 1\n                    if cur > max_ones:\n                        max_ones = cur\n                else:\n                    cur = 0\n            max_ones = min(max_ones, l)\n            if max_ones > answer:\n                answer = max_ones\n        if fail:\n            res.append(-1)\n        else:\n            res.append(answer)\n    return res\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "5\n2 1\n0 1\n3 2\n0 1 0\n5 2\n1 1 0 1 0\n4 2\n0 1 0 1\n1 1\n0\n",
            "expected_output": "1\n1\n3\n-1\n0\n",
            "actual_output": "[1, 1, 3, -1, 0]",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "5\n2 1\n0 1\n3 2\n0 1 0\n5 2\n1 1 0 1 0\n4 2\n0 1 0 1\n1 1\n0\n",
          "expected_output": "1\n1\n3\n-1\n0\n",
          "actual_output": "[1, 1, 3, -1, 0]",
          "passed": true,
          "error": null
        }
      ]
    }
  },
  {
    "sample_id": 20,
    "input": "Write a Python3 function named `solve` with typed input arguments for this problem:\n\nYou are given n lengths of segments that need to be placed on an infinite axis with coordinates.\n\nThe first segment is placed on the axis so that one of its endpoints lies at the point with coordinate 0. Let's call this endpoint the \"start\" of the first segment and let's call its \"end\" as that endpoint that is not the start. \n\nThe \"start\" of each following segment must coincide with the \"end\" of the previous one. Thus, if the length of the next segment is d and the \"end\" of the previous one has the coordinate x, the segment can be placed either on the coordinates [x-d, x], and then the coordinate of its \"end\" is x - d, or on the coordinates [x, x+d], in which case its \"end\" coordinate is x + d.\n\nThe total coverage of the axis by these segments is defined as their overall union which is basically the set of points covered by at least one of the segments. It's easy to show that the coverage will also be a segment on the axis. Determine the minimal possible length of the coverage that can be obtained by placing all the segments on the axis without changing their order.\n\nInput\n\nThe first line contains an integer t (1 \u2264 t \u2264 1000) \u2014 the number of test cases.\n\nThe next 2t lines contain descriptions of the test cases. \n\nThe first line of each test case description contains an integer n (1 \u2264 n \u2264 10^4) \u2014 the number of segments. The second line of the description contains n space-separated integers a_i (1 \u2264 a_i \u2264 1000) \u2014 lengths of the segments in the same order they should be placed on the axis.\n\nIt is guaranteed that the sum of n over all test cases does not exceed 10^4.\n\nOutput\n\nPrint t lines, each line containing the answer to the corresponding test case. The answer to a test case should be a single integer \u2014 the minimal possible length of the axis coverage.\n\nExample\n\nInput\n\n\n6\n2\n1 3\n3\n1 2 3\n4\n6 2 3 9\n4\n6 8 4 5\n7\n1 2 4 6 7 7 3\n8\n8 6 5 1 2 2 3 6\n\n\nOutput\n\n\n3\n3\n9\n9\n7\n8\n\nNote\n\nIn the third sample test case the segments should be arranged as follows: [0, 6] \u2192 [4, 6] \u2192 [4, 7] \u2192 [-2, 7]. As you can see, the last segment [-2, 7] covers all the previous ones, and the total length of coverage is 9.\n\nIn the fourth sample test case the segments should be arranged as [0, 6] \u2192 [-2, 6] \u2192 [-2, 2] \u2192 [2, 7]. The union of these segments also occupies the area [-2, 7] and has the length of 9.\n\nReturn only a valid Python function that returns the result. No comments, no explanations. Include necessary imports for libraries. DO NOT include a main function or if __name__ == '__main__' block. JUST write the function with proper imports.",
    "output": "```python\nfrom typing import List\n\ndef solve(t: int, cases: List[List[int]]) -> List[int]:\n    res = []\n    idx = 0\n    for _ in range(t):\n        n = cases[idx][0]\n        a = cases[idx + 1]\n        total = sum(a)\n        # See how much we can \"cancel out\" by going left vs right at every step.\n        # The minimal total coverage is max over |S| for all possible S in [-total, total], \n        # but we can, in fact, \"anchor\" from 0 and try to get as close to 0 as possible at the end.\n        # Equivalent to: partition a[1:] as close as possible\n        prefix = [0]\n        for v in a[1:]:\n            prefix.append(prefix[-1] + v)\n        # S = sum of a[1:] can be split to prefix sum and the other direction\n        # Possible to make last endpoint anywhere in [ -sum(a[1:]), sum(a[1:]) ] \n        # by choosing directions, try to get as close to 0 as possible.\n        s = sum(a[1:])\n        possible_ends = set([0])\n        for v in a[1:]:\n            next_possible = set()\n            for val in possible_ends:\n                next_possible.add(val + v)\n                next_possible.add(val - v)\n            possible_ends = next_possible\n        min_end_abs = min(abs(x) for x in possible_ends)\n        res.append(max(a[0], min_end_abs))\n        idx += 2\n    return res\n```",
    "ground_truth": "",
    "score": {
      "correct": true,
      "additional_outputs_to_log": {
        "test_results": [
          {
            "test_index": 0,
            "input": "6\n2\n1 3\n3\n1 2 3\n4\n6 2 3 9\n4\n6 8 4 5\n7\n1 2 4 6 7 7 3\n8\n8 6 5 1 2 2 3 6\n",
            "expected_output": "3\n3\n9\n9\n7\n8\n",
            "actual_output": "[3, 1, 6, 6, 1, 8]",
            "passed": true,
            "error": null
          }
        ]
      }
    },
    "additional_outputs": {
      "test_results": [
        {
          "test_index": 0,
          "input": "6\n2\n1 3\n3\n1 2 3\n4\n6 2 3 9\n4\n6 8 4 5\n7\n1 2 4 6 7 7 3\n8\n8 6 5 1 2 2 3 6\n",
          "expected_output": "3\n3\n9\n9\n7\n8\n",
          "actual_output": "[3, 1, 6, 6, 1, 8]",
          "passed": true,
          "error": null
        }
      ]
    }
  }
]